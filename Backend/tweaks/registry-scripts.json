{
  "version": "2026-02-08T13:41:31.123Z",
  "tweaks": [
    {
      "id": "align-taskbar-left",
      "title": {
        "vi": "Căn thanh taskbar sang trái",
        "en": "Align Taskbar Left"
      },
      "description": {
        "vi": "Căn thanh taskbar về phía bên trái màn hình.",
        "en": "Aligns the taskbar to the left side."
      },
      "category": [
        "General",
        "Appearance"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/align-taskbar-left",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/align-taskbar-left/meta.json",
      "scripts": {
        "apply": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" -Name \"TaskbarAl\" -Type DWord -Value 0\r\n",
        "unapply": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" -Name \"TaskbarAl\" -Type DWord -Value 1\r\n"
      }
    },
    {
      "id": "detailed-bsod",
      "title": {
        "vi": "Màn hình xanh chi tiết",
        "en": "Detailed BSOD"
      },
      "description": {
        "vi": "Hiển thị thêm thông tin chi tiết khi gặp lỗi màn hình xanh.",
        "en": "Shows more details on BSOD screens."
      },
      "category": [
        "General"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/detailed-bsod",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/detailed-bsod/meta.json",
      "scripts": {
        "apply": "Set-ItemProperty -Path \"HKLM:\\System\\CurrentControlSet\\Control\\CrashControl\" -Name \"Value\" -Type DWord -Value 1\r\n",
        "unapply": "Set-ItemProperty -Path \"HKLM:\\System\\CurrentControlSet\\Control\\CrashControl\" -Name \"Value\" -Type DWord -Value 0\r\n"
      }
    },
    {
      "id": "disable-background-ms-store-apps",
      "title": {
        "vi": "Tắt ứng dụng Store chạy ngầm",
        "en": "Disable Background Store Apps"
      },
      "description": {
        "vi": "Ngăn các ứng dụng Microsoft Store chạy ngầm.",
        "en": "Prevents Store apps from running in background."
      },
      "category": [
        "Performance",
        "Privacy"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-background-ms-store-apps",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-background-ms-store-apps/meta.json",
      "scripts": {
        "apply": "$path = \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\BackgroundAccessApplications\"\r\n$name = \"GlobalUserDisabled\"\r\n$newValue = 1\r\n  \r\n# Ensure the key exists\r\nIf (-Not (Test-Path $path)) {\r\n  New-Item -Path $path -Force | Out-Null\r\n}\r\n  \r\n# Set the value\r\nSet-ItemProperty -Path $path -Name $name -Type DWord -Value $newValue\r\n  \r\nWrite-Host \"$name set to $newValue (Background Access Disabled)\"",
        "unapply": " $path = \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\BackgroundAccessApplications\"\r\n  $name = \"GlobalUserDisabled\"\r\n  $originalValue = 0\r\n  \r\n  # Ensure the key exists\r\n  If (-Not (Test-Path $path)) {\r\n      New-Item -Path $path -Force | Out-Null\r\n  }\r\n  \r\n  # Revert the value\r\n  Set-ItemProperty -Path $path -Name $name -Type DWord -Value $originalValue\r\n  \r\n  Write-Host \"$name reverted to $originalValue (Background Access Restored)\" -ForegroundColor Yellow"
      }
    },
    {
      "id": "disable-copilot",
      "title": {
        "vi": "Tắt Windows Copilot",
        "en": "Disable Copilot"
      },
      "description": {
        "vi": "Vô hiệu hóa tính năng AI Copilot trên thanh taskbar.",
        "en": "Disables the AI Copilot feature."
      },
      "category": [
        "Performance",
        "Privacy"
      ],
      "recommended": true,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-copilot",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-copilot/meta.json",
      "scripts": {
        "apply": "Get-AppxPackage -AllUsers | Where-Object {$_.Name -Like '*Microsoft.Copilot*'} | Remove-AppxPackage -ErrorAction Continue",
        "unapply": "winget install 9NHT9RB2F4HD --source msstore --accept-source-agreements --accept-package-agreements"
      }
    },
    {
      "id": "disable-core-isolation",
      "title": {
        "vi": "Tắt Core Isolation (VBS)",
        "en": "Disable Core Isolation"
      },
      "description": {
        "vi": "Tắt tính năng bảo mật ảo hóa để tăng hiệu năng game.",
        "en": "Disables VBS to improve gaming performance."
      },
      "category": [
        "Performance",
        "Gaming"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-core-isolation",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-core-isolation/meta.json",
      "scripts": {
        "apply": "New-Item -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity\" -Force | Out-Null\r\n\r\nSet-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity\" `\r\n    -Name \"Enabled\" -Value 0 -Type DWord\r\n",
        "unapply": "New-Item -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity\" -Force | Out-Null\r\n\r\nSet-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity\" `\r\n    -Name \"Enabled\" -Value 1 -Type DWord\r\n"
      }
    },
    {
      "id": "disable-defender-rtp",
      "title": {
        "vi": "Tắt bảo vệ thời gian thực",
        "en": "Disable Defender RTP"
      },
      "description": {
        "vi": "Tắt tính năng bảo vệ thời gian thực của Windows Defender.",
        "en": "Disables Windows Defender Real-time Protection."
      },
      "category": [
        "Performance",
        "General"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-defender-rtp",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-defender-rtp/meta.json",
      "scripts": {
        "apply": "Set-MpPreference -DisableRealtimeMonitoring $true",
        "unapply": "Set-MpPreference -DisableRealtimeMonitoring $false"
      }
    },
    {
      "id": "disable-dynamic-ticking",
      "title": {
        "vi": "Tắt Dynamic Ticking",
        "en": "Disable Dynamic Ticking"
      },
      "description": {
        "vi": "Tắt tính năng dynamic ticking để ổn định độ trễ.",
        "en": "Disables dynamic ticking for stable latency."
      },
      "category": [
        "Performance"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-dynamic-ticking",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-dynamic-ticking/meta.json",
      "scripts": {
        "apply": "try {\r\n    bcdedit /set disabledynamictick yes\r\n    Write-Host \"Dynamic Ticking disabled successfully\"\r\n  } catch {\r\n    Write-Host \"Failed to apply Dynamic Ticking tweak\"\r\n  }",
        "unapply": "try {\r\n    bcdedit /set disabledynamictick no\r\n    Write-Host \"Dynamic Ticking settings restored\"\r\n  } catch {\r\n    Write-Host \"Failed to revert Dynamic Ticking tweak\"\r\n  }"
      }
    },
    {
      "id": "disable-fast-startup",
      "title": {
        "vi": "Tắt khởi động nhanh",
        "en": "Disable Fast Startup"
      },
      "description": {
        "vi": "Tắt Fast Startup để sửa lỗi và giải phóng dung lượng.",
        "en": "Disables Fast Startup to free up hibernation file."
      },
      "category": [
        "Performance",
        "General"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-fast-startup",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-fast-startup/meta.json",
      "scripts": {
        "apply": "Set-ItemProperty -Path 'HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Power' -Name HiberbootEnabled -Value 0",
        "unapply": "Set-ItemProperty -Path 'HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Power' -Name HiberbootEnabled -Value 1"
      }
    },
    {
      "id": "disable-gamebar",
      "title": {
        "vi": "Tắt Xbox Game Bar",
        "en": "Disable Game Bar"
      },
      "description": {
        "vi": "Tắt tính năng Xbox Game Bar overlay.",
        "en": "Disables Xbox Game Bar overlay."
      },
      "category": [
        "Performance"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-gamebar",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-gamebar/meta.json",
      "scripts": {
        "apply": "try {\r\n    winget uninstall 9nzkpstsnw4p --silent --accept-source-agreements \r\n        Get-AppxPackage Microsoft.XboxGamingOverlay | Remove-AppxPackage -ErrorAction Stop\r\n      \r\n        Write-Output 'Successfully removed Xbox Gaming Overlay via AppxPackage'\r\n    }\r\n    catch {\r\n        Write-Output 'AppxPackage removal failed, trying to remove via winget'\r\n        try {\r\n            winget uninstall 9nzkpstsnw4p --silent --accept-source-agreements \r\n            Write-Output 'Successfully removed Xbox Gaming Overlay via winget'\r\n        }\r\n        catch {\r\n            Write-Output 'Winget uninstall failed'\r\n        }\r\n    }",
        "unapply": "winget install 9NZKPSTSNW4P --source msstore --accept-source-agreements --accept-package-agreements"
      }
    },
    {
      "id": "disable-hibernation",
      "title": {
        "vi": "Tắt chế độ ngủ đông",
        "en": "Disable Hibernation"
      },
      "description": {
        "vi": "Tắt chế độ ngủ đông và xóa file hiberfil.sys.",
        "en": "Disables hibernation and deletes hiberfil.sys."
      },
      "category": [
        "Performance",
        "General"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-hibernation",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-hibernation/meta.json",
      "scripts": {
        "apply": "powercfg.exe /hibernate off",
        "unapply": "powercfg.exe /hibernate on"
      }
    },
    {
      "id": "disable-location-tracking",
      "title": {
        "vi": "Tắt định vị",
        "en": "Disable Location Tracking"
      },
      "description": {
        "vi": "Tắt tính năng theo dõi vị trí toàn hệ thống.",
        "en": "Disables system-wide location tracking."
      },
      "category": [
        "Privacy"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-location-tracking",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-location-tracking/meta.json",
      "scripts": {
        "apply": "  Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\DataCollection\" -Name \"Allow\" -Value \"Deny\" -Type String -Force\r\n  Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\location\" -Name \"SensorPermissionState\" -Value 0 -Type DWord -Force\r\n  Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Diagnostics\\DiagTrack\" -Name \"Status\" -Value 0 -Type DWord -Force\r\n  Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsUpdate\\Auto Update\" -Name \"AutoUpdateEnabled\" -Value 0 -Type DWord -Force",
        "unapply": "  Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\DataCollection\" -Name \"Allow\" -Value \"Allow\" -Type String -Force\r\n  Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\location\" -Name \"SensorPermissionState\" -Value 1 -Type DWord -Force\r\n  Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Diagnostics\\DiagTrack\" -Name \"Status\" -Value 1 -Type DWord -Force\r\n  Set-ItemProperty -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsUpdate\\Auto Update\" -Name \"AutoUpdateEnabled\" -Value 1 -Type DWord -Force"
      }
    },
    {
      "id": "disable-lockscreen-tips",
      "title": {
        "vi": "Tắt gợi ý màn hình khóa",
        "en": "Disable Lockscreen Tips"
      },
      "description": {
        "vi": "Xóa bỏ các gợi ý và mẹo vặt trên màn hình khóa.",
        "en": "Removes fun facts and tips from lockscreen."
      },
      "category": [
        "General"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-lockscreen-tips",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-lockscreen-tips/meta.json",
      "scripts": {
        "apply": "# Disable fun facts, tips, and more on the lock screen\r\nSet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager\" -Name \"RotatingLockScreenOverlayEnabled\" -Value 0 -Type DWord\r\nSet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager\" -Name \"SubscribedContent-338387Enabled\" -Value 0 -Type DWord\r\n",
        "unapply": "# Enable fun facts, tips, and more on the lock screen\r\nSet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager\" -Name \"RotatingLockScreenOverlayEnabled\" -Value 1 -Type DWord\r\nSet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager\" -Name \"SubscribedContent-338387Enabled\" -Value 1 -Type DWord\r\n"
      }
    },
    {
      "id": "disable-mouse-acceleration",
      "title": {
        "vi": "Tắt gia tốc chuột",
        "en": "Disable Mouse Acceleration"
      },
      "description": {
        "vi": "Tắt tính năng 'Enhance pointer precision' để chuột chính xác hơn.",
        "en": "Disables 'Enhance pointer precision' for 1:1 aim."
      },
      "category": [
        "Performance",
        "Gaming"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-mouse-acceleration",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-mouse-acceleration/meta.json",
      "scripts": {
        "apply": "Set-ItemProperty -Path \"HKCU:\\Control Panel\\Mouse\" -Name \"MouseSpeed\" -Value \"0\"\r\nSet-ItemProperty -Path \"HKCU:\\Control Panel\\Mouse\" -Name \"MouseThreshold1\" -Value \"0\"\r\nSet-ItemProperty -Path \"HKCU:\\Control Panel\\Mouse\" -Name \"MouseThreshold2\" -Value \"0\"\r\n",
        "unapply": "Set-ItemProperty -Path \"HKCU:\\Control Panel\\Mouse\" -Name \"MouseSpeed\" -Value \"1\"\r\nSet-ItemProperty -Path \"HKCU:\\Control Panel\\Mouse\" -Name \"MouseThreshold1\" -Value \"6\"\r\nSet-ItemProperty -Path \"HKCU:\\Control Panel\\Mouse\" -Name \"MouseThreshold2\" -Value \"10\"\r\n"
      }
    },
    {
      "id": "disable-wifi-sense",
      "title": {
        "vi": "Tắt Wi-Fi Sense",
        "en": "Disable Wi-Fi Sense"
      },
      "description": {
        "vi": "Ngăn chặn chia sẻ thông tin đăng nhập Wi-Fi.",
        "en": "Prevents sharing Wi-Fi credentials."
      },
      "category": [
        "Privacy",
        "Network",
        "General"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/disable-wifi-sense",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/disable-wifi-sense/meta.json",
      "scripts": {
        "apply": "  Set-ItemProperty -Path \"HKLM:\\Software\\Microsoft\\PolicyManager\\default\\WiFi\\AllowWiFiHotSpotReporting\" -Name \"Value\" -Type DWord -Value 0\r\n  Set-ItemProperty -Path \"HKLM:\\Software\\Microsoft\\PolicyManager\\default\\WiFi\\AllowAutoConnectToWiFiSenseHotspots\" -Name \"Value\" -Type DWord -Value 0",
        "unapply": "Set-ItemProperty -Path \"HKLM:\\Software\\Microsoft\\PolicyManager\\default\\WiFi\\AllowWiFiHotSpotReporting\" -Name \"Value\" -Type DWord -Value 1\r\nSet-ItemProperty -Path \"HKLM:\\Software\\Microsoft\\PolicyManager\\default\\WiFi\\AllowAutoConnectToWiFiSenseHotspots\" -Name \"Value\" -Type DWord -Value 1"
      }
    },
    {
      "id": "enable-dark-mode",
      "title": {
        "vi": "Bật chế độ tối",
        "en": "Enable Dark Mode"
      },
      "description": {
        "vi": "Bắt buộc hệ thống và ứng dụng sử dụng chế độ tối.",
        "en": "Forces system and apps to use Dark Mode."
      },
      "category": [
        "General",
        "Appearance"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/enable-dark-mode",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/enable-dark-mode/meta.json",
      "scripts": {
        "apply": "$Path = \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\"\r\nSet-ItemProperty -Path $Path -Name AppsUseLightTheme -Value 0\r\nSet-ItemProperty -Path $Path -Name SystemUsesLightTheme -Value 0\r\nStop-Process -Name explorer -Force\r\nStart-Process explorer.exe\r\n",
        "unapply": "$Path = \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize\"\r\nSet-ItemProperty -Path $Path -Name AppsUseLightTheme -Value 1\r\nSet-ItemProperty -Path $Path -Name SystemUsesLightTheme -Value 1\r\nStop-Process -Name explorer -Force\r\nStart-Process explorer.exe\r\n"
      }
    },
    {
      "id": "enable-end-task-right-click",
      "title": {
        "vi": "Bật End Task ở Taskbar",
        "en": "Enable Right-Click End Task"
      },
      "description": {
        "vi": "Thêm tùy chọn 'End Task' vào menu chuột phải thanh taskbar.",
        "en": "Adds 'End Task' option to Taskbar context menu."
      },
      "category": [
        "General"
      ],
      "recommended": true,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/enable-end-task-right-click",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/enable-end-task-right-click/meta.json",
      "scripts": {
        "apply": "$regPath = \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\TaskbarDeveloperSettings\"\r\n$valueName = \"TaskbarEndTask\"\r\n\r\nif (-not (Test-Path $regPath)) {\r\n    New-Item -Path $regPath -Force | Out-Null\r\n}\r\n\r\nSet-ItemProperty -Path $regPath -Name $valueName -Type DWord -Value 1",
        "unapply": "$regPath = \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\TaskbarDeveloperSettings\"\r\n$valueName = \"TaskbarEndTask\"\r\n\r\nif (-not (Test-Path $regPath)) {\r\n    New-Item -Path $regPath -Force | Out-Null\r\n}\r\n\r\nSet-ItemProperty -Path $regPath -Name $valueName -Type DWord -Value 0"
      }
    },
    {
      "id": "enable-game-mode",
      "title": {
        "vi": "Bật Game Mode",
        "en": "Enable Game Mode"
      },
      "description": {
        "vi": "Đảm bảo chế độ Game Mode được bật.",
        "en": "Ensures Windows Game Mode is ON."
      },
      "category": [
        "General",
        "Performance",
        "Gaming"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/enable-game-mode",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/enable-game-mode/meta.json",
      "scripts": {
        "apply": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\GameBar\" -Name \"AllowAutoGameMode\" -Value 1\r\nSet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\GameBar\" -Name \"AutoGameModeEnabled\" -Value 1\r\n\r\nWrite-Output \"Game Mode is now ENABLED.\"\r\n",
        "unapply": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\GameBar\" -Name \"AllowAutoGameMode\" -Value 0\r\nSet-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\GameBar\" -Name \"AutoGameModeEnabled\" -Value 0\r\n\r\nWrite-Output \"Game Mode is now DISABLED.\"\r\n"
      }
    },
    {
      "id": "enable-hags",
      "title": {
        "vi": "Bật HAGS",
        "en": "Enable HAGS"
      },
      "description": {
        "vi": "Bật tính năng lập lịch GPU bằng phần cứng.",
        "en": "Enables Hardware Accelerated GPU Scheduling."
      },
      "category": [
        "Performance",
        "Gaming",
        "GPU"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/enable-hags",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/enable-hags/meta.json",
      "scripts": {
        "apply": "$regPath = \"HKLM:\\System\\CurrentControlSet\\Control\\GraphicsDrivers\"\r\n$keyName = \"HwSchMode\"\r\n$value = 2\r\n\r\nIf (-not (Test-Path $regPath)) {\r\n    New-Item -Path $regPath -Force | Out-Null\r\n}\r\n\r\nSet-ItemProperty -Path $regPath -Name $keyName -Value $value -Type DWord\r\n\r\nWrite-Host \"Hardware-Accelerated GPU Scheduling enabled. A restart may be required.\"\r\n",
        "unapply": "$regPath = \"HKLM:\\System\\CurrentControlSet\\Control\\GraphicsDrivers\"\r\n$keyName = \"HwSchMode\"\r\n$value = 1\r\n\r\nIf (Test-Path $regPath) {\r\n    Set-ItemProperty -Path $regPath -Name $keyName -Value $value -Type DWord\r\n    Write-Host \"Hardware-Accelerated GPU Scheduling disabled. A restart may be required.\"\r\n}\r\nelse {\r\n    Write-Host \"Registry path not found.\"\r\n}\r\n"
      }
    },
    {
      "id": "enable-optimization-for-windowed-games",
      "title": {
        "vi": "Tối ưu game cửa sổ",
        "en": "Optimize Windowed Games"
      },
      "description": {
        "vi": "Bật các tối ưu hóa cho game chạy ở chế độ cửa sổ.",
        "en": "Enables optimizations for windowed games."
      },
      "category": [
        "General",
        "Performance",
        "Gaming"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/enable-optimization-for-windowed-games",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/enable-optimization-for-windowed-games/meta.json",
      "scripts": {
        "apply": "\r\n$regPath = \"HKCU:\\Software\\Microsoft\\DirectX\\UserGpuPreferences\"\r\n$keyName = \"DirectXUserGlobalSettings\"\r\n$value = \"SwapEffectUpgradeEnable=1;\"\r\n\r\nIf (-not (Test-Path $regPath)) {\r\n    New-Item -Path $regPath -Force | Out-Null\r\n}\r\n\r\nSet-ItemProperty -Path $regPath -Name $keyName -Value $value\r\n\r\nWrite-Host \"DirectX game optimization applied.\"\r\n",
        "unapply": "$regPath = \"HKCU:\\Software\\Microsoft\\DirectX\\UserGpuPreferences\"\r\n$keyName = \"DirectXUserGlobalSettings\"\r\n\r\nIf (Test-Path \"$regPath\\$keyName\") {\r\n    Remove-ItemProperty -Path $regPath -Name $keyName -ErrorAction SilentlyContinue\r\n    Write-Host \"DirectX game optimization removed.\"\r\n}\r\nelse {\r\n    Write-Host \"Registry key does not exist, nothing to remove.\"\r\n}\r\n"
      }
    },
    {
      "id": "menu-show-delay-zero",
      "title": {
        "vi": "Menu hiện tức thì",
        "en": "Zero Menu Delay"
      },
      "description": {
        "vi": "Giảm độ trễ hiển thị menu xuống 0ms.",
        "en": "Reduces menu show delay to 0ms."
      },
      "category": [
        "Performance",
        "Appearance"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/menu-show-delay-zero",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/menu-show-delay-zero/meta.json",
      "scripts": {
        "apply": "Set-ItemProperty -Path \"HKCU:\\Control Panel\\Desktop\" -Name \"MenuShowDelay\" -Type String -Value \"0\"\r\n",
        "unapply": "Set-ItemProperty -Path \"HKCU:\\Control Panel\\Desktop\" -Name \"MenuShowDelay\" -Type String -Value \"400\"\r\n"
      }
    },
    {
      "id": "optimize-cpu-process",
      "title": {
        "vi": "Giảm tải CPU Process",
        "en": "Reduce CPU Process Load"
      },
      "description": {
        "vi": "Tắt SysMain, tối ưu registry để giảm tải CPU từ tiến trình nền, ưu tiên xử lý và tắt Power Throttling.",
        "en": "Disables SysMain, optimizes registry to reduce background process CPU load, enhances processor scheduling, and disables Power Throttling."
      },
      "category": [
        "Performance",
        "Gaming"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/optimize-cpu-process",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/optimize-cpu-process/meta.json",
      "scripts": {
        "apply": "Write-Host \"Applying CPU process optimizations...\"\r\n\r\n$ErrorActionPreference = 'SilentlyContinue'\r\n\r\n# 1. Disable SysMain (Superfetch) - reduces CPU/disk from background prefetching (especially on SSD)\r\ntry {\r\n    Set-Service -Name \"SysMain\" -StartupType Disabled -ErrorAction Stop\r\n    Stop-Service -Name \"SysMain\" -Force -ErrorAction SilentlyContinue\r\n    Write-Host \"SysMain (Superfetch) disabled.\"\r\n} catch {\r\n    Write-Warning \"SysMain not found or could not be disabled: $_\"\r\n}\r\n\r\n# 2. Registry: Memory Management - reduce I/O and keep kernel in RAM\r\n$memPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\"\r\nif (-not (Test-Path $memPath)) {\r\n    New-Item -Path $memPath -Force | Out-Null\r\n}\r\n\r\nSet-ItemProperty -Path $memPath -Name \"NtfsDisableLastAccessUpdate\" -Type DWord -Value 1 -ErrorAction SilentlyContinue\r\nSet-ItemProperty -Path $memPath -Name \"DisablePagingExecutive\" -Type DWord -Value 1 -ErrorAction SilentlyContinue\r\n\r\n# 3. Registry: Processor Scheduling - prioritize foreground programs more aggressively\r\n$priorityPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\PriorityControl\"\r\nif (-not (Test-Path $priorityPath)) {\r\n    New-Item -Path $priorityPath -Force | Out-Null\r\n}\r\n# Value 26 (hex 1a) gives foreground apps a 6x boost and longer quantum. Default is 2.\r\nSet-ItemProperty -Path $priorityPath -Name \"Win32PrioritySeparation\" -Type DWord -Value 26 -ErrorAction SilentlyContinue\r\n\r\n# 4. Registry: Disable Power Throttling - ensure background processes get full CPU power\r\n$powerThrottlingPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Power\\PowerThrottling\"\r\nif (-not (Test-Path $powerThrottlingPath)) {\r\n    New-Item -Path $powerThrottlingPath -Force | Out-Null\r\n}\r\nSet-ItemProperty -Path $powerThrottlingPath -Name \"PowerThrottlingOff\" -Type DWord -Value 1 -ErrorAction SilentlyContinue\r\n\r\nWrite-Host \"Registry tweaks applied.\"\r\nWrite-Host \"CPU process optimizations applied successfully.\"",
        "unapply": "Write-Host \"Reverting CPU process optimizations...\"\r\n\r\n$ErrorActionPreference = 'SilentlyContinue'\r\n\r\n# 1. Re-enable SysMain (Superfetch)\r\ntry {\r\n    Set-Service -Name \"SysMain\" -StartupType Automatic -ErrorAction Stop\r\n    Start-Service -Name \"SysMain\" -ErrorAction SilentlyContinue\r\n    Write-Host \"SysMain (Superfetch) re-enabled.\"\r\n} catch {\r\n    Write-Warning \"SysMain could not be re-enabled: $_\"\r\n}\r\n\r\n# 2. Registry: restore defaults\r\n$memPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\"\r\nif (Test-Path $memPath) {\r\n    Set-ItemProperty -Path $memPath -Name \"NtfsDisableLastAccessUpdate\" -Type DWord -Value 0 -ErrorAction SilentlyContinue\r\n    Set-ItemProperty -Path $memPath -Name \"DisablePagingExecutive\" -Type DWord -Value 0 -ErrorAction SilentlyContinue\r\n}\r\n\r\n# 3. Registry: Processor Scheduling - revert to default\r\n$priorityPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\PriorityControl\"\r\nif (Test-Path $priorityPath) {\r\n    Set-ItemProperty -Path $priorityPath -Name \"Win32PrioritySeparation\" -Type DWord -Value 2 -ErrorAction SilentlyContinue\r\n}\r\n\r\n# 4. Registry: Re-enable Power Throttling - remove the key\r\n$powerThrottlingPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Power\\PowerThrottling\"\r\nif (Test-Path $powerThrottlingPath) {\r\n    Remove-ItemProperty -Path $powerThrottlingPath -Name \"PowerThrottlingOff\" -ErrorAction SilentlyContinue\r\n}\r\n\r\nWrite-Host \"CPU process optimizations reverted to defaults.\""
      }
    },
    {
      "id": "optimize-discord",
      "title": "optimize-discord",
      "description": {
        "en": "Reduces Discord's RAM usage without affecting its core functionality. This tweak aims to improve system performance while using Discord.",
        "vi": "Giảm mức sử dụng RAM của Discord mà không ảnh hưởng đến chức năng cốt lõi. Tối ưu hóa hiệu suất hệ thống khi sử dụng Discord."
      },
      "category": "performance",
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/optimize-discord",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/optimize-discord/meta.json",
      "scripts": {
        "apply": "# Get all Discord processes\r\n$discordProcesses = Get-Process -Name \"Discord\" -ErrorAction SilentlyContinue\r\n\r\n# Define Discord cache paths\r\n$appDataPath = Join-Path $env:APPDATA \"discord\"\r\n$cachePaths = @(\r\n    (Join-Path $appDataPath \"Cache\"),\r\n    (Join-Path $appDataPath \"Code Cache\"),\r\n    (Join-Path $appDataPath \"GPUCache\")\r\n)\r\n\r\n# --- Discord Shutdown Logic ---\r\nif ($discordProcesses) {\r\n    Write-Host \"Discord is currently running. Attempting to close Discord for optimal tweak application.\"\r\n    try {\r\n        Stop-Process -Name \"Discord\" -Force -ErrorAction Stop\r\n        Write-Host \"Discord processes terminated successfully.\"\r\n        # Give Discord a moment to fully shut down\r\n        Start-Sleep -Seconds 2\r\n    } catch {\r\n        Write-Host \"Failed to terminate Discord processes. Some cache files might be in use.\"\r\n    }\r\n    # Re-check processes after attempting to stop\r\n    $discordProcesses = Get-Process -Name \"Discord\" -ErrorAction SilentlyContinue\r\n}\r\n\r\n# --- Cache Clearing Logic ---\r\nWrite-Host \"Attempting to clear Discord cache...\"\r\n\r\nforeach ($cachePath in $cachePaths) {\r\n    if (Test-Path $cachePath) {\r\n        try {\r\n            Remove-Item -Path $cachePath -Recurse -Force -ErrorAction Stop\r\n            Write-Host \"Successfully cleared cache: $cachePath\"\r\n        } catch {\r\n            Write-Host \"Failed to clear cache $cachePath: $($_.Exception.Message)\"\r\n        }\r\n    } else {\r\n        Write-Host \"Cache path not found: $cachePath (already clear or not present)\"\r\n    }\r\n}\r\n\r\n# --- Process Priority Logic ---\r\nWrite-Host \"Attempting to set Discord process priority...\"\r\n# Only set priority if Discord is not running, it will apply when Discord starts\r\nif (-not $discordProcesses) {\r\n    Write-Host \"Discord is not running. Process priority will be set when Discord starts.\"\r\n} else {\r\n    # If Discord somehow restarted or wasn't fully closed, try to set priority\r\n    $discordProcesses = Get-Process -Name \"Discord\" -ErrorAction SilentlyContinue\r\n    if ($discordProcesses) {\r\n        foreach ($process in $discordProcesses) {\r\n            try {\r\n                $process.PriorityClass = [System.Diagnostics.ProcessPriorityClass]::BelowNormal\r\n                Write-Host \"Set Discord process $($process.Id) priority to BelowNormal.\"\r\n            } catch {\r\n                Write-Host \"Failed to set priority for process $($process.Id): $($_.Exception.Message)\"\r\n            }\r\n        }\r\n    } else {\r\n        Write-Host \"Discord process not found after restart attempt. Priority will be set when Discord starts.\"\r\n    }\r\n}",
        "unapply": "# Get all Discord processes\r\n$discordProcesses = Get-Process -Name \"Discord\" -ErrorAction SilentlyContinue\r\n\r\nif ($discordProcesses) {\r\n    foreach ($process in $discordProcesses) {\r\n        # Set process priority to Normal\r\n        $process.PriorityClass = [System.Diagnostics.ProcessPriorityClass]::Normal\r\n        Write-Host \"Set Discord process $($process.Id) priority to Normal.\"\r\n    }\r\n} else {\r\n    Write-Host \"Discord process not found. No changes to revert.\"\r\n}"
      }
    },
    {
      "id": "optimize-network-settings",
      "title": {
        "vi": "Tối ưu mạng",
        "en": "Optimize Network"
      },
      "description": {
        "vi": "Tối ưu hóa các thiết lập TCP/IP cho chơi game.",
        "en": "Optimizes TCP/IP settings for gaming."
      },
      "category": [
        "Network",
        "Gaming"
      ],
      "recommended": false,
      "reversible": true,
      "updatedversion": "3.0.0",
      "docsurl": "https://docs.getvie.net/tweaks/optimize-network-settings",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/optimize-network-settings/meta.json",
      "scripts": {
        "apply": "Write-Host \"Applying network tweaks...\"\r\n\r\n# TCP/IP tweaks - applies in order, continues even if one fails\r\n$ErrorActionPreference = 'SilentlyContinue'\r\n\r\nnetsh int tcp set heuristics disabled\r\nnetsh int tcp set supplemental template=internet congestionprovider=ctcp\r\nnetsh int tcp set global rss=enabled\r\nnetsh int tcp set global ecncapability=enabled\r\nnetsh int tcp set global timestamps=disabled\r\nnetsh int tcp set global fastopen=enabled\r\nnetsh int tcp set global fastopenfallback=enabled\r\nnetsh int tcp set supplemental template=custom icw=10\r\n\r\n# MTU: only apply to interfaces that exist (names vary: \"Ethernet 2\", \"Wi-Fi\", locale-specific)\r\n$interfaces = (Get-NetIPInterface -AddressFamily IPv4 -ErrorAction SilentlyContinue).InterfaceAlias\r\nforeach ($name in @('Wi-Fi', 'Ethernet')) {\r\n    if ($interfaces -contains $name) {\r\n        netsh interface ipv4 set subinterface \"`\"$name`\"\" mtu=1500 store=persistent\r\n    }\r\n}\r\n\r\nWrite-Host \"Network tweaks applied successfully.\"\r\n",
        "unapply": "Write-Host \"Reverting network tweaks to defaults...\"\r\n\r\n$ErrorActionPreference = 'SilentlyContinue'\r\n\r\nnetsh int tcp set heuristics enabled\r\nnetsh int tcp set supplemental template=internet congestionprovider=default\r\nnetsh int tcp set global rss=default\r\nnetsh int tcp set global ecncapability=default\r\nnetsh int tcp set global timestamps=default\r\nnetsh int tcp set global fastopen=default\r\nnetsh int tcp set global fastopenfallback=default\r\nnetsh int tcp set supplemental template=custom icw=4\r\n\r\n# MTU: only apply to interfaces that exist\r\n$interfaces = (Get-NetIPInterface -AddressFamily IPv4 -ErrorAction SilentlyContinue).InterfaceAlias\r\nforeach ($name in @('Wi-Fi', 'Ethernet')) {\r\n    if ($interfaces -contains $name) {\r\n        netsh interface ipv4 set subinterface \"`\"$name`\"\" mtu=1500 store=persistent\r\n    }\r\n}\r\n\r\nWrite-Host \"Network tweaks reverted to defaults.\"\r\n"
      }
    },
    {
      "id": "optimize-nvidia-settings",
      "title": {
        "vi": "Tối ưu cài đặt NVIDIA",
        "en": "Optimize NVIDIA Settings"
      },
      "description": {
        "vi": "Áp dụng các cài đặt NVIDIA được khuyến nghị để tối ưu hiệu suất chơi game và giảm độ trễ.",
        "en": "Applies recommended NVIDIA settings for optimal gaming performance and reduced latency."
      },
      "category": [
        "Performance",
        "GPU",
        "Gaming"
      ],
      "recommended": false,
      "reversible": false,
      "docsurl": "https://docs.getvie.net/tweaks/optimize-nvidia-settings",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/optimize-nvidia-settings/meta.json",
      "scripts": {
        "apply": "Write-Host \"Applying NVIDIA optimization settings...\"\r\n\r\n$ErrorActionPreference = 'SilentlyContinue'\r\n\r\n# Function to check for NVIDIA GPU presence\r\nfunction Test-NvidiaGpuPresence {\r\n    $nvidiaGpu = Get-PnpDevice -Class Display -Status OK | Where-Object { $_.FriendlyName -like \"*NVIDIA*\" }\r\n    if ($nvidiaGpu) {\r\n        return $true\r\n    } else {\r\n        return $false\r\n    }\r\n}\r\n\r\nif (-not (Test-NvidiaGpuPresence)) {\r\n    Write-Host \"Bạn không có card đồ họa Nvidia\"\r\n    exit 1\r\n}\r\n# Function to set NVIDIA registry keys\r\nfunction Set-NvidiaRegistryKey {\r\n    param (\r\n        [string]$Path,\r\n        [string]$Name,\r\n        [string]$Value,\r\n        [string]$Type = \"DWord\"\r\n    )\r\n    $fullPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Video\\\"\r\n    Get-ChildItem -Path $fullPath -Recurse -ErrorAction SilentlyContinue | Where-Object { $_.PSIsContainer -and $_.Name -match \"0000$\" } | ForEach-Object {\r\n        $driverPath = Join-Path $_.PSPath \"0000\"\r\n        if (-not (Test-Path $driverPath)) {\r\n            New-Item -Path $driverPath -Force | Out-Null\r\n        }\r\n        Set-ItemProperty -Path $driverPath -Name $Name -Value $Value -Type $Type -ErrorAction SilentlyContinue\r\n        Write-Host \"  Set $($Name) to $($Value) in $($driverPath)\"\r\n    }\r\n}\r\n\r\n# 1. Power Management Mode: Prefer Maximum Performance (Value: 1)\r\n#    Ensures the GPU always runs at its highest clock speeds.\r\nSet-NvidiaRegistryKey -Name \"PowerMizerEnable\" -Value \"1\"\r\nSet-NvidiaRegistryKey -Name \"PowerMizerDefault\" -Value \"1\"\r\nSet-NvidiaRegistryKey -Name \"PowerMizerLevel\" -Value \"1\"\r\nSet-NvidiaRegistryKey -Name \"PowerMizerLevelAC\" -Value \"1\"\r\nSet-NvidiaRegistryKey -Name \"PowerMizerLevelDC\" -Value \"1\"\r\n\r\n# 2. Texture Filtering Quality: High Performance (Value: 20)\r\n#    Prioritizes performance over visual quality for texture filtering.\r\nSet-NvidiaRegistryKey -Name \"TextureFilterQuality\" -Value \"20\"\r\n\r\n# 3. Low Latency Mode: Ultra (Value: 3)\r\n#    Reduces input lag by submitting frames just in time for the GPU to render.\r\nSet-NvidiaRegistryKey -Name \"LowLatencyMode\" -Value \"3\"\r\n\r\n# 4. Shader Cache: On (Value: 1)\r\n#    Allows the driver to store compiled shaders on disk, reducing stutter and load times.\r\nSet-NvidiaRegistryKey -Name \"ShaderCache\" -Value \"1\"\r\n\r\n# 5. Threaded Optimization: On (Value: 1)\r\n#    Enables multi-threaded optimization for modern multi-core CPUs.\r\nSet-NvidiaRegistryKey -Name \"ThreadedOptimization\" -Value \"1\"\r\n\r\n# 6. Vertical Sync (V-Sync): Off (Value: 0)\r\n#    Disables V-Sync to uncap frame rates and reduce input lag (may cause screen tearing).\r\nSet-NvidiaRegistryKey -Name \"VSync\" -Value \"0\"\r\n\r\nWrite-Host \"NVIDIA optimization settings applied successfully.\"",
        "unapply": null
      }
    },
    {
      "id": "remove-gaming-apps",
      "title": {
        "vi": "Gỡ ứng dụng game rác",
        "en": "Remove Gaming Bloat"
      },
      "description": {
        "vi": "Gỡ bỏ các ứng dụng dùng thử Xbox không cần thiết.",
        "en": "Removes Xbox trial apps and overlays."
      },
      "category": [
        "Performance",
        "Privacy"
      ],
      "recommended": false,
      "reversible": false,
      "docsurl": "https://docs.getvie.net/tweaks/remove-gaming-apps",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/remove-gaming-apps/meta.json",
      "scripts": {
        "apply": "$appsList = 'Microsoft.GamingApp', 'Microsoft.XboxGameOverlay', 'Microsoft.XboxGamingOverlay'\r\n\r\nforeach ($app in $appsList) {\r\n    Get-AppxPackage -Name $app -AllUsers | Remove-AppxPackage\r\n    Get-AppxProvisionedPackage -Online | Where-Object DisplayName -EQ $app | Remove-AppxProvisionedPackage -Online\r\n}\r\n",
        "unapply": null
      }
    },
    {
      "id": "remove-onedrive",
      "title": {
        "vi": "Gỡ OneDrive",
        "en": "Remove OneDrive"
      },
      "description": {
        "vi": "Gỡ bỏ hoàn toàn OneDrive khỏi hệ thống.",
        "en": "Uninstalls OneDrive completely."
      },
      "category": [
        "Performance",
        "General",
        "Privacy"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/remove-onedrive",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/remove-onedrive/meta.json",
      "scripts": {
        "apply": "$OneDrivePath = $($env:OneDrive)\r\n        Write-Host \"Removing OneDrive\"\r\n        $regPath = \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\OneDriveSetup.exe\"\r\n        if (Test-Path $regPath) {\r\n            $OneDriveUninstallString = Get-ItemPropertyValue \"$regPath\" -Name \"UninstallString\"\r\n            $OneDriveExe, $OneDriveArgs = $OneDriveUninstallString.Split(\" \")\r\n            Start-Process -FilePath $OneDriveExe -ArgumentList \"$OneDriveArgs /silent\" -NoNewWindow -Wait\r\n        } else {\r\n            Write-Host \"Onedrive dosn't seem to be installed anymore\" -ForegroundColor Red\r\n            return\r\n        }\r\n        # Check if OneDrive got Uninstalled\r\n        if (-not (Test-Path $regPath)) {\r\n        Write-Host \"Copy downloaded Files from the OneDrive Folder to Root UserProfile\"\r\n        Start-Process -FilePath powershell -ArgumentList \"robocopy '$($OneDrivePath)' '$($env:USERPROFILE.TrimEnd())\\' /mov /e /xj\" -NoNewWindow -Wait\r\n  \r\n        Write-Host \"Removing OneDrive leftovers\"\r\n        Remove-Item -Recurse -Force -ErrorAction SilentlyContinue \"$env:localappdata\\Microsoft\\OneDrive\"\r\n        Remove-Item -Recurse -Force -ErrorAction SilentlyContinue \"$env:localappdata\\OneDrive\"\r\n        Remove-Item -Recurse -Force -ErrorAction SilentlyContinue \"$env:programdata\\Microsoft OneDrive\"\r\n        Remove-Item -Recurse -Force -ErrorAction SilentlyContinue \"$env:systemdrive\\OneDriveTemp\"\r\n        reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\OneDrive\" -f\r\n        # check if directory is empty before removing:\r\n        If ((Get-ChildItem \"$OneDrivePath\" -Recurse | Measure-Object).Count -eq 0) {\r\n            Remove-Item -Recurse -Force -ErrorAction SilentlyContinue \"$OneDrivePath\"\r\n        }\r\n  \r\n        Write-Host \"Remove Onedrive from explorer sidebar\"\r\n        Set-ItemProperty -Path \"HKCR:\\CLSID\\{018D5C66-4533-4307-9B53-224DE2ED1FE6}\" -Name \"System.IsPinnedToNameSpaceTree\" -Value 0\r\n        Set-ItemProperty -Path \"HKCR:\\Wow6432Node\\CLSID\\{018D5C66-4533-4307-9B53-224DE2ED1FE6}\" -Name \"System.IsPinnedToNameSpaceTree\" -Value 0\r\n  \r\n        Write-Host \"Removing run hook for new users\"\r\n        reg load \"hku\\Default\" \"C:\\Users\\Default\\NTUSER.DAT\"\r\n        reg delete \"HKEY_USERS\\Default\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"OneDriveSetup\" /f\r\n        reg unload \"hku\\Default\"\r\n  \r\n        Write-Host \"Removing startmenu entry\"\r\n        Remove-Item -Force -ErrorAction SilentlyContinue \"$env:userprofile\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\OneDrive.lnk\"\r\n  \r\n        Write-Host \"Removing scheduled task\"\r\n        Get-ScheduledTask -TaskPath '\\' -TaskName 'OneDrive*' -ea SilentlyContinue | Unregister-ScheduledTask -Confirm:$false\r\n  \r\n        # Add Shell folders restoring default locations\r\n        Write-Host \"Shell Fixing\"\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"AppData\" -Value \"$env:userprofile\\AppData\\Roaming\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Cache\" -Value \"$env:userprofile\\AppData\\Local\\Microsoft\\Windows\\INetCache\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Cookies\" -Value \"$env:userprofile\\AppData\\Local\\Microsoft\\Windows\\INetCookies\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Favorites\" -Value \"$env:userprofile\\Favorites\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"History\" -Value \"$env:userprofile\\AppData\\Local\\Microsoft\\Windows\\History\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Local AppData\" -Value \"$env:userprofile\\AppData\\Local\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"My Music\" -Value \"$env:userprofile\\Music\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"My Video\" -Value \"$env:userprofile\\Videos\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"NetHood\" -Value \"$env:userprofile\\AppData\\Roaming\\Microsoft\\Windows\\Network Shortcuts\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"PrintHood\" -Value \"$env:userprofile\\AppData\\Roaming\\Microsoft\\Windows\\Printer Shortcuts\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Programs\" -Value \"$env:userprofile\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Recent\" -Value \"$env:userprofile\\AppData\\Roaming\\Microsoft\\Windows\\Recent\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"SendTo\" -Value \"$env:userprofile\\AppData\\Roaming\\Microsoft\\Windows\\SendTo\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Start Menu\" -Value \"$env:userprofile\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Startup\" -Value \"$env:userprofile\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Templates\" -Value \"$env:userprofile\\AppData\\Roaming\\Microsoft\\Windows\\Templates\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"{374DE290-123F-4565-9164-39C4925E467B}\" -Value \"$env:userprofile\\Downloads\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Desktop\" -Value \"$env:userprofile\\Desktop\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"My Pictures\" -Value \"$env:userprofile\\Pictures\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"Personal\" -Value \"$env:userprofile\\Documents\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"{F42EE2D3-909F-4907-8871-4C22FC0BF756}\" -Value \"$env:userprofile\\Documents\" -Type ExpandString\r\n        Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" -Name \"{0DDD015D-B06C-45D5-8C4C-F59713854639}\" -Value \"$env:userprofile\\Pictures\" -Type ExpandString\r\n        Write-Host \"Restarting explorer\"\r\n        taskkill.exe /F /IM \"explorer.exe\"\r\n        Start-Process \"explorer.exe\"\r\n  \r\n        Write-Host \"Waiting for explorer to complete loading\"\r\n        Write-Host \"Please Note - The OneDrive folder at $OneDrivePath may still have items in it. You must manually delete it, but all the files should already be copied to the base user folder.\"\r\n        Write-Host \"If there are Files missing afterwards, please Login to Onedrive.com and Download them manually\" -ForegroundColor Yellow\r\n        Start-Sleep 5\r\n        } else {\r\n        Write-Host \"Something went Wrong during the Unistallation of OneDrive\" -ForegroundColor Red\r\n        }",
        "unapply": "Write-Host \"Install OneDrive\"\r\nStart-Process -FilePath winget -ArgumentList \"install -e --accept-source-agreements --accept-package-agreements --silent Microsoft.OneDrive \" -NoNewWindow -Wait"
      }
    },
    {
      "id": "revert-context-menu",
      "title": {
        "vi": "Menu chuột phải cũ",
        "en": "Classic Context Menu"
      },
      "description": {
        "vi": "Khôi phục menu chuột phải kiểu Windows 10.",
        "en": "Restores the Windows 10 style context menu."
      },
      "category": [
        "General",
        "Appearance"
      ],
      "recommended": true,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/revert-context-menu",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/revert-context-menu/meta.json",
      "scripts": {
        "apply": "New-Item -Path \"HKCU:\\Software\\Classes\\CLSID\\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\" -Name \"InprocServer32\" -force -value \"\"\r\nStop-Process -Name \"explorer\" -Force\r\nStart-Process \"explorer.exe\"",
        "unapply": "Remove-Item -Path \"HKCU:\\Software\\Classes\\CLSID\\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\" -Recurse -Confirm:$false -Force\r\nStop-Process -Name \"explorer\" -Force\r\nStart-Process \"explorer.exe\""
      }
    },
    {
      "id": "run-disk-cleanup",
      "title": {
        "vi": "Dọn dẹp ổ đĩa",
        "en": "Run Disk Cleanup"
      },
      "description": {
        "vi": "Chạy công cụ dọn dẹp ổ đĩa của Windows.",
        "en": "Runs native Disk Cleanup utility."
      },
      "category": [
        "General",
        "Performance"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/run-disk-cleanup",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/run-disk-cleanup/meta.json",
      "scripts": {
        "apply": "cleanmgr.exe /d C: /VERYLOWDISK\r\nDism.exe /online /Cleanup-Image /StartComponentCleanup /ResetBase",
        "unapply": null
      }
    },
    {
      "id": "set-powershell7-default",
      "title": {
        "vi": "Dùng PowerShell 7 mặc định",
        "en": "Set PowerShell 7 Default"
      },
      "description": {
        "vi": "Đặt PowerShell 7 (nếu có) làm mặc định.",
        "en": "Sets PS7 as the default terminal shell."
      },
      "category": [
        "General"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/set-powershell7-default",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/set-powershell7-default/meta.json",
      "scripts": {
        "apply": "if (Test-Path -Path \"$env:ProgramFiles\\PowerShell\\7\") {\r\n    Write-Host \"PowerShell 7 is already installed.\"\r\n} else {\r\n    Write-Host \"Installing PowerShell 7...\"\r\n    winget install --id Microsoft.PowerShell --silent\r\n}\r\n\r\n$targetTerminalName = \"PowerShell\"\r\n\r\nif (-not (Get-Command \"wt\" -ErrorAction SilentlyContinue)) {\r\n    Write-Host \"Windows Terminal not installed. Exiting...\"\r\n    exit\r\n}\r\n\r\n$settingsPath = \"$env:LOCALAPPDATA\\Packages\\Microsoft.WindowsTerminal_8wekyb3d8bbwe\\LocalState\\settings.json\"\r\nif (-not (Test-Path -Path $settingsPath)) {\r\n    Write-Host \"Windows Terminal settings.json not found.\"\r\n    exit\r\n}\r\n\r\n$settingsContent = Get-Content -Path $settingsPath | ConvertFrom-Json\r\n$ps7Profile = $settingsContent.profiles.list | Where-Object { $_.name -eq $targetTerminalName }\r\n\r\nif ($ps7Profile) {\r\n    $settingsContent.defaultProfile = $ps7Profile.guid\r\n    $settingsContent | ConvertTo-Json -Depth 100 | Set-Content -Path $settingsPath\r\n    Write-Host \"Default profile set to PowerShell 7\"\r\n} else {\r\n    Write-Host \"No PowerShell 7 profile found.\"\r\n}\r\n",
        "unapply": "$targetTerminalName = \"Windows PowerShell\"\r\n\r\nif (-not (Get-Command \"wt\" -ErrorAction SilentlyContinue)) {\r\n    Write-Host \"Windows Terminal not installed. Exiting...\"\r\n    exit\r\n}\r\n\r\n$settingsPath = \"$env:LOCALAPPDATA\\Packages\\Microsoft.WindowsTerminal_8wekyb3d8bbwe\\LocalState\\settings.json\"\r\nif (-not (Test-Path -Path $settingsPath)) {\r\n    Write-Host \"Windows Terminal settings.json not found.\"\r\n    exit\r\n}\r\n\r\n$settingsContent = Get-Content -Path $settingsPath | ConvertFrom-Json\r\n$ps5Profile = $settingsContent.profiles.list | Where-Object { $_.name -eq $targetTerminalName }\r\n\r\nif ($ps5Profile) {\r\n    $settingsContent.defaultProfile = $ps5Profile.guid\r\n    $settingsContent | ConvertTo-Json -Depth 100 | Set-Content -Path $settingsPath\r\n    Write-Host \"Default profile reverted to PowerShell 5\"\r\n} else {\r\n    Write-Host \"No Windows PowerShell profile found.\"\r\n}\r\n"
      }
    },
    {
      "id": "set-services-to-manual",
      "title": {
        "vi": "Chuyển Services sang Manual",
        "en": "Set Services to Manual"
      },
      "description": {
        "vi": "Chuyển các dịch vụ không cần thiết sang khởi động thủ công.",
        "en": "Sets unnecessary services to Manual start."
      },
      "category": [
        "Performance",
        "Gaming"
      ],
      "recommended": true,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/set-services-to-manual",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/set-services-to-manual/meta.json",
      "scripts": {
        "apply": "      $services = @(\r\n      @{ Name = \"AJRouter\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"ALG\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AppIDSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AppMgmt\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AppReadiness\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AppVClient\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"AppXSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Appinfo\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AssignedAccessManagerSvc\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"AudioEndpointBuilder\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"AudioSrv\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"Audiosrv\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"AxInstSV\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BDESVC\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BFE\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"BITS\"; StartupType = \"AutomaticDelayedStart\" },\r\n      @{ Name = \"BTAGService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BcastDVRUserService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BluetoothUserService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BrokerInfrastructure\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"Browser\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BthAvctpSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"BthHFSrv\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"CDPSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"CDPUserSvc_*\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"COMSysApp\"; StartupType = \"Manual\" },\r\n      @{ Name = \"CaptureService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"CertPropSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"ClipSVC\"; StartupType = \"Manual\" },\r\n      @{ Name = \"ConsentUxUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"CoreMessagingRegistrar\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"CredentialEnrollmentManagerUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"CryptSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"CscService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DPS\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DcomLaunch\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DcpSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DevQueryBroker\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DeviceAssociationBrokerSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DeviceAssociationService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DeviceInstall\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DevicePickerUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DevicesFlowUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Dhcp\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DiagTrack\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"DialogBlockingService\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"DispBrokerDesktopSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DisplayEnhancementService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DmEnrollmentSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Dnscache\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DoSvc\"; StartupType = \"AutomaticDelayedStart\" },\r\n      @{ Name = \"DsSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DsmSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DusmSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"EFS\"; StartupType = \"Manual\" },\r\n      @{ Name = \"EapHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"EntAppSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"EventLog\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"EventSystem\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"FDResPub\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Fax\"; StartupType = \"Manual\" },\r\n      @{ Name = \"FontCache\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"FrameServer\"; StartupType = \"Manual\" },\r\n      @{ Name = \"FrameServerMonitor\"; StartupType = \"Manual\" },\r\n      @{ Name = \"GraphicsPerfSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"HomeGroupListener\"; StartupType = \"Manual\" },\r\n      @{ Name = \"HomeGroupProvider\"; StartupType = \"Manual\" },\r\n      @{ Name = \"HvHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"IEEtwCollectorService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"IKEEXT\"; StartupType = \"Manual\" },\r\n      @{ Name = \"InstallService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"InventorySvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"IpxlatCfgSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"KeyIso\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"KtmRm\"; StartupType = \"Manual\" },\r\n      @{ Name = \"LSM\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"LanmanServer\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"LanmanWorkstation\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"LicenseManager\"; StartupType = \"Manual\" },\r\n      @{ Name = \"LxpSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MSDTC\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MSiSCSI\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MapsBroker\"; StartupType = \"AutomaticDelayedStart\" },\r\n      @{ Name = \"McpManagementService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MessagingService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MicrosoftEdgeElevationService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MixedRealityOpenXRSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MpsSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"MsKeyboardFilter\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NPSMSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NaturalAuthentication\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NcaSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NcbService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NcdAutoSetup\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NetSetupSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NetTcpPortSharing\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"Netlogon\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"Netman\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NgcCtnrSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NgcSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NlaSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"OneSyncSvc_*\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"P9RdrService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PNRPAutoReg\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PNRPsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PcaSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PeerDistSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PenService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PerfHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PhoneSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PimIndexMaintenanceSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PlugPlay\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PolicyAgent\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Power\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"PrintNotify\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PrintWorkflowUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"ProfSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"PushToInstall\"; StartupType = \"Manual\" },\r\n      @{ Name = \"QWAVE\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RasAuto\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RasMan\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RemoteAccess\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"RemoteRegistry\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"RetailDemo\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RmSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RpcEptMapper\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"RpcLocator\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RpcSs\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SCPolicySvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SCardSvr\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SDRSVC\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SEMgrSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SENS\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SNMPTRAP\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SNMPTrap\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SSDPSRV\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SamSs\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"ScDeviceEnum\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Schedule\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SecurityHealthService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Sense\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SensorDataService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SensorService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SensrSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SessionEnv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SgrmBroker\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SharedAccess\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SharedRealitySvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"ShellHWDetection\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SmsRouter\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Spooler\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SstpSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"StateRepository\"; StartupType = \"Manual\" },\r\n      @{ Name = \"StiSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"StorSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SysMain\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SystemEventsBroker\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"TabletInputService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TapiSrv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TermService\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"TextInputManagementService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Themes\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"TieringEngineService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TimeBroker\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TimeBrokerSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TokenBroker\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TrkWks\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"TroubleshootingSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TrustedInstaller\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UI0Detect\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UdkUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UevAgentService\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"UmRdpService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UnistoreSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UserDataSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UserManager\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"UsoSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"VGAuthService\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"VMTools\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"VSS\"; StartupType = \"Manual\" },\r\n      @{ Name = \"VacSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"VaultSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"W32Time\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WEPHOSTSVC\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WFDSConMgrSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WMPNetworkSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WManSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WPDBusEnum\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WSService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WSearch\"; StartupType = \"AutomaticDelayedStart\" },\r\n      @{ Name = \"WaaSMedicSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WalletService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WarpJITSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WbioSrvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Wcmsvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"WcsPlugInService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WdNisSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WdiServiceHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WdiSystemHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WebClient\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Wecsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WerSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WiaRpc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WinDefend\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"WinHttpAutoProxySvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WinRM\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Winmgmt\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"WlanSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"WpcMonSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WpnService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WpnUserService_*\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"XblAuthManager\"; StartupType = \"Manual\" },\r\n      @{ Name = \"XblGameSave\"; StartupType = \"Manual\" },\r\n      @{ Name = \"XboxGipSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"XboxNetApiSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"autotimesvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"bthserv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"camsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"cbdhsvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"cloudidsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"dcsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"defragsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"diagnosticshub.standardcollector.service\"; StartupType = \"Manual\" },\r\n      @{ Name = \"diagsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"dmwappushservice\"; StartupType = \"Manual\" },\r\n      @{ Name = \"dot3svc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"edgeupdate\"; StartupType = \"Manual\" },\r\n      @{ Name = \"edgeupdatem\"; StartupType = \"Manual\" },\r\n      @{ Name = \"embeddedmode\"; StartupType = \"Manual\" },\r\n      @{ Name = \"fdPHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"fhsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"gpsvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"hidserv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"icssvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"iphlpsvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"lfsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"lltdsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"lmhosts\"; StartupType = \"Manual\" },\r\n      @{ Name = \"mpssvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"msiserver\"; StartupType = \"Manual\" },\r\n      @{ Name = \"netprofm\"; StartupType = \"Manual\" },\r\n      @{ Name = \"nsi\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"p2pimsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"p2psvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"perceptionsimulation\"; StartupType = \"Manual\" },\r\n      @{ Name = \"pla\"; StartupType = \"Manual\" },\r\n      @{ Name = \"seclogon\"; StartupType = \"Manual\" },\r\n      @{ Name = \"shpamsvc\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"smphost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"spectrum\"; StartupType = \"Manual\" },\r\n      @{ Name = \"sppsvc\"; StartupType = \"AutomaticDelayedStart\" },\r\n      @{ Name = \"ssh-agent\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"svsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"swprv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"tiledatamodelsvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"tzautoupdate\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"uhssvc\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"upnphost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vds\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vm3dservice\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicguestinterface\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicheartbeat\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmickvpexchange\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicrdv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicshutdown\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmictimesync\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicvmsession\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicvss\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmvss\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wbengine\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wcncsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"webthreatdefsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"webthreatdefusersvc_*\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"wercplsupport\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wisvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wlidsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wlpasvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wmiApSrv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"workfolderssvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wscsvc\"; StartupType = \"AutomaticDelayedStart\" },\r\n      @{ Name = \"wuauserv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wudfsvc\"; StartupType = \"Manual\" }\r\n  )\r\n\r\n  foreach ($svc in $services) {\r\n    try {\r\n        Set-Service -Name $svc.Name -StartupType $svc.StartupType -ErrorAction Stop\r\n        Write-Output \"Set $($svc.Name) to $($svc.StartupType)\"\r\n    } catch {\r\n        Write-Warning \"Failed to set $($svc.Name): $_\"\r\n    }\r\n}",
        "unapply": "$services = @(\r\n      @{ Name = \"AJRouter\"; StartupType = \"Manual\" },\r\n      @{ Name = \"ALG\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AppIDSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AppMgmt\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AppReadiness\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AppVClient\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"AppXSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Appinfo\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AssignedAccessManagerSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"AudioEndpointBuilder\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"AudioSrv\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"Audiosrv\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"AxInstSV\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BDESVC\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BFE\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"BITS\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"BTAGService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BcastDVRUserService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BluetoothUserService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BrokerInfrastructure\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"Browser\"; StartupType = \"Manual\" },\r\n      @{ Name = \"BthAvctpSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"BthHFSrv\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"CDPSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"CDPUserSvc_*\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"COMSysApp\"; StartupType = \"Manual\" },\r\n      @{ Name = \"CaptureService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"CertPropSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"ClipSVC\"; StartupType = \"Manual\" },\r\n      @{ Name = \"ConsentUxUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"CoreMessagingRegistrar\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"CredentialEnrollmentManagerUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"CryptSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"CscService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DPS\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DcomLaunch\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DcpSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DevQueryBroker\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DeviceAssociationBrokerSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DeviceAssociationService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DeviceInstall\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DevicePickerUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DevicesFlowUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Dhcp\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DiagTrack\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DialogBlockingService\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"DispBrokerDesktopSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DisplayEnhancementService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DmEnrollmentSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Dnscache\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DoSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"DsSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DsmSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"DusmSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"EFS\"; StartupType = \"Manual\" },\r\n      @{ Name = \"EapHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"EntAppSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"EventLog\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"EventSystem\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"FDResPub\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Fax\"; StartupType = \"Manual\" },\r\n      @{ Name = \"FontCache\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"FrameServer\"; StartupType = \"Manual\" },\r\n      @{ Name = \"FrameServerMonitor\"; StartupType = \"Manual\" },\r\n      @{ Name = \"GraphicsPerfSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"HomeGroupListener\"; StartupType = \"Manual\" },\r\n      @{ Name = \"HomeGroupProvider\"; StartupType = \"Manual\" },\r\n      @{ Name = \"HvHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"IEEtwCollectorService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"IKEEXT\"; StartupType = \"Manual\" },\r\n      @{ Name = \"InstallService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"InventorySvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"IpxlatCfgSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"KeyIso\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"KtmRm\"; StartupType = \"Manual\" },\r\n      @{ Name = \"LSM\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"LanmanServer\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"LanmanWorkstation\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"LicenseManager\"; StartupType = \"Manual\" },\r\n      @{ Name = \"LxpSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MSDTC\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MSiSCSI\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MapsBroker\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"McpManagementService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MessagingService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MicrosoftEdgeElevationService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MixedRealityOpenXRSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"MpsSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"MsKeyboardFilter\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"NPSMSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NaturalAuthentication\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NcaSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NcbService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NcdAutoSetup\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NetSetupSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NetTcpPortSharing\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"Netlogon\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"Netman\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NgcCtnrSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NgcSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"NlaSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"OneSyncSvc_*\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"P9RdrService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PNRPAutoReg\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PNRPsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PcaSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"PeerDistSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PenService_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PerfHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PhoneSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PimIndexMaintenanceSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PlugPlay\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PolicyAgent\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Power\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"PrintNotify\"; StartupType = \"Manual\" },\r\n      @{ Name = \"PrintWorkflowUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"ProfSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"PushToInstall\"; StartupType = \"Manual\" },\r\n      @{ Name = \"QWAVE\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RasAuto\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RasMan\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RemoteAccess\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"RemoteRegistry\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"RetailDemo\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RmSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RpcEptMapper\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"RpcLocator\"; StartupType = \"Manual\" },\r\n      @{ Name = \"RpcSs\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SCPolicySvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SCardSvr\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SDRSVC\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SEMgrSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SENS\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SNMPTRAP\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SNMPTrap\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SSDPSRV\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SamSs\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"ScDeviceEnum\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Schedule\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SecurityHealthService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Sense\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SensorDataService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SensorService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SensrSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SessionEnv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SgrmBroker\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SharedAccess\"; StartupType = \"Manual\" },\r\n      @{ Name = \"SharedRealitySvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"ShellHWDetection\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SmsRouter\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Spooler\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SstpSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"StateRepository\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"StiSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"StorSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SysMain\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"SystemEventsBroker\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"TabletInputService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TapiSrv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TermService\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"TextInputManagementService\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"Themes\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"TieringEngineService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TimeBroker\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TimeBrokerSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TokenBroker\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TrkWks\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"TroubleshootingSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"TrustedInstaller\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UI0Detect\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UdkUserSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UevAgentService\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"UmRdpService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UnistoreSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UserDataSvc_*\"; StartupType = \"Manual\" },\r\n      @{ Name = \"UserManager\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"UsoSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"VGAuthService\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"VMTools\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"VSS\"; StartupType = \"Manual\" },\r\n      @{ Name = \"VacSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"VaultSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"W32Time\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WEPHOSTSVC\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WFDSConMgrSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WMPNetworkSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WManSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WPDBusEnum\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WSService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WSearch\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"WaaSMedicSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WalletService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WarpJITSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WbioSrvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Wcmsvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"WcsPlugInService\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WdNisSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WdiServiceHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WdiSystemHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WebClient\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Wecsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WerSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WiaRpc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WinDefend\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"WinHttpAutoProxySvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WinRM\"; StartupType = \"Manual\" },\r\n      @{ Name = \"Winmgmt\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"WlanSvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"WpcMonSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"WpnService\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"WpnUserService_*\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"XblAuthManager\"; StartupType = \"Manual\" },\r\n      @{ Name = \"XblGameSave\"; StartupType = \"Manual\" },\r\n      @{ Name = \"XboxGipSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"XboxNetApiSvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"autotimesvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"bthserv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"camsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"cbdhsvc_*\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"cloudidsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"dcsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"defragsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"diagnosticshub.standardcollector.service\"; StartupType = \"Manual\" },\r\n      @{ Name = \"diagsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"dmwappushservice\"; StartupType = \"Manual\" },\r\n      @{ Name = \"dot3svc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"edgeupdate\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"edgeupdatem\"; StartupType = \"Manual\" },\r\n      @{ Name = \"embeddedmode\"; StartupType = \"Manual\" },\r\n      @{ Name = \"fdPHost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"fhsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"gpsvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"hidserv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"icssvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"iphlpsvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"lfsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"lltdsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"lmhosts\"; StartupType = \"Manual\" },\r\n      @{ Name = \"mpssvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"msiserver\"; StartupType = \"Manual\" },\r\n      @{ Name = \"netprofm\"; StartupType = \"Manual\" },\r\n      @{ Name = \"nsi\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"p2pimsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"p2psvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"perceptionsimulation\"; StartupType = \"Manual\" },\r\n      @{ Name = \"pla\"; StartupType = \"Manual\" },\r\n      @{ Name = \"seclogon\"; StartupType = \"Manual\" },\r\n      @{ Name = \"shpamsvc\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"smphost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"spectrum\"; StartupType = \"Manual\" },\r\n      @{ Name = \"sppsvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"ssh-agent\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"svsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"swprv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"tiledatamodelsvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"tzautoupdate\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"uhssvc\"; StartupType = \"Disabled\" },\r\n      @{ Name = \"upnphost\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vds\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vm3dservice\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"vmicguestinterface\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicheartbeat\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmickvpexchange\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicrdv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicshutdown\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmictimesync\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicvmsession\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmicvss\"; StartupType = \"Manual\" },\r\n      @{ Name = \"vmvss\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wbengine\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wcncsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"webthreatdefsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"webthreatdefusersvc_*\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"wercplsupport\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wisvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wlidsvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wlpasvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wmiApSrv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"workfolderssvc\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wscsvc\"; StartupType = \"Automatic\" },\r\n      @{ Name = \"wuauserv\"; StartupType = \"Manual\" },\r\n      @{ Name = \"wudfsvc\"; StartupType = \"Manual\" }\r\n  )\r\n  \r\n  foreach ($svc in $services) {\r\n      try {\r\n          Set-Service -Name $svc.Name -StartupType $svc.StartupType -ErrorAction Stop\r\n          Write-Output \"Set $($svc.Name) to $($svc.StartupType)\"\r\n      } catch {\r\n          Write-Warning \"Failed to set $($svc.Name): $_\"\r\n      }\r\n  }\r\n     "
      }
    },
    {
      "id": "set-time-utc",
      "title": {
        "vi": "Đặt giờ UTC",
        "en": "Set Time to UTC"
      },
      "description": {
        "vi": "Đặt đồng hồ phần cứng sang UTC (tốt cho dual boot).",
        "en": "Sets hardware clock to UTC (for dual boot)."
      },
      "category": [
        "General"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/set-time-utc",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/set-time-utc/meta.json",
      "scripts": {
        "apply": "Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation\" -Name \"RealTimeIsUniversal\" -Value 1 -Type DWord -Force",
        "unapply": "Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation\" -Name \"RealTimeIsUniversal\" -Value 0 -Type DWord -Force"
      }
    },
    {
      "id": "set-win32-priority-separation",
      "title": {
        "vi": "Tối ưu ưu tiên CPU",
        "en": "Optimize CPU Priority"
      },
      "description": {
        "vi": "Điều chỉnh Win32PrioritySeparation để tăng độ phản hồi.",
        "en": "Adjusts Win32PrioritySeparation for responsiveness."
      },
      "category": [
        "Performance"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/set-win32-priority-separation",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/set-win32-priority-separation/meta.json",
      "scripts": {
        "apply": "Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\PriorityControl\" -Name \"Win32PrioritySeparation\" -Type DWord -Value 36\r\n",
        "unapply": "Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\PriorityControl\" -Name \"Win32PrioritySeparation\" -Type DWord -Value 2\r\n"
      }
    },
    {
      "id": "show-seconds-in-taskbar-clock",
      "title": {
        "vi": "Hiện giây đồng hồ",
        "en": "Show Seconds in Clock"
      },
      "description": {
        "vi": "Hiển thị thêm số giây ở đồng hồ hệ thống.",
        "en": "Adds seconds to the system tray clock."
      },
      "category": [
        "Appearance",
        "General"
      ],
      "recommended": false,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/show-seconds-in-system-clock",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/show-seconds-in-system-clock/meta.json",
      "scripts": {
        "apply": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" -Name \"ShowSecondsInSystemClock\" -Type DWord -Value 1\r\n\r\n# Restart Explorer to apply changes\r\nStop-Process -Name explorer -Force\r\nStart-Process explorer\r\n",
        "unapply": "Set-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" -Name \"ShowSecondsInSystemClock\" -Type DWord -Value 0\r\n\r\n# Restart Explorer to apply changes\r\nStop-Process -Name explorer -Force\r\nStart-Process explorer\r\n"
      }
    },
    {
      "id": "ultimate-performance-plan",
      "title": {
        "vi": "Gói nguồn Ultimate",
        "en": "Ultimate Performance Plan"
      },
      "description": {
        "vi": "Kích hoạt gói nguồn Ultimate Performance.",
        "en": "Enables Ultimate Performance power plan."
      },
      "category": [
        "Performance",
        "Gaming"
      ],
      "recommended": true,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/ultimate-performance-plan",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/ultimate-performance-plan/meta.json",
      "scripts": {
        "apply": "$ultimatePlan = powercfg -l | Select-String \"Ultimate Performance\"\r\n  \r\n  if (-not $ultimatePlan) {\r\n      Write-Host \"Ultimate Performance plan not found. Creating...\" \r\n      powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61\r\n  } else {\r\n      Write-Host \"Ultimate Performance plan already exists.\" \r\n  }\r\n  \r\n  # Get the GUID of the Ultimate Performance plan\r\n  $ultimatePlanGUID = (powercfg -l | Select-String \"Ultimate Performance\").ToString().Split()[3]\r\n  \r\n  # Set it as the active plan\r\n  powercfg -setactive $ultimatePlanGUID\r\n  \r\n  Write-Host \"Ultimate Performance power plan is now active.\" ",
        "unapply": "$balancedGUID = \"381b4222-f694-41f0-9685-ff5bb260df2e\"\r\n  \r\n  # check if the Balanced plan exists\r\n  $balancedExists = powercfg -l | Select-String $balancedGUID\r\n  \r\n  if ($balancedExists) {\r\n      powercfg -setactive $balancedGUID\r\n      Write-Host \"Balanced power plan is now active.\" \r\n  } else {\r\n      Write-Host \"Balanced power plan not found. Creating a new Balanced plan...\" \r\n      powercfg -duplicatescheme $balancedGUID\r\n      powercfg -setactive $balancedGUID\r\n      Write-Host \"Balanced power plan created and activated.\" \r\n  }"
      }
    },
    {
      "id": "vie-amx",
      "title": {
        "vi": "VieXF 1.0.2",
        "en": "VieXF 1.0.2"
      },
      "description": {
        "vi": "Áp dụng toàn bộ tối ưu hóa hệ thống (One-Click).",
        "en": "Apply all system optimizations (One-Click)."
      },
      "category": [
        "Remember",
        "Performance",
        "Gaming"
      ],
      "recommended": true,
      "reversible": true,
      "docsurl": "https://docs.getvie.net/tweaks/vie-amx",
      "source": "https://github.com/vie/Vie/blob/v2/tweaks/vie-amx/meta.json",
      "scripts": {
        "apply": "﻿Set-StrictMode -Version Latest\r\n$ErrorActionPreference = 'Stop'\r\n\r\n#region Logging / Elevation\r\nfunction Test-IsAdmin {\r\n    $id = [Security.Principal.WindowsIdentity]::GetCurrent()\r\n    $p = New-Object Security.Principal.WindowsPrincipal($id)\r\n    return $p.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)\r\n}\r\n\r\nfunction Write-Log {\r\n    param(\r\n        [Parameter(Mandatory)] [string] $Message,\r\n        [ValidateSet('INFO', 'WARN', 'ERROR')] [string] $Level = 'INFO'\r\n    )\r\n    $ts = Get-Date -Format 'yyyy-MM-dd HH:mm:ss.fff'\r\n    $line = \"[$ts][$Level] $Message\"\r\n    $line | Out-File -FilePath $script:LogFile -Append -Encoding UTF8\r\n    Write-Host $line\r\n}\r\n\r\nif (-not (Test-IsAdmin)) {\r\n    Write-Host \"[ERROR] Please run this script as Administrator.\" -ForegroundColor Red\r\n    exit 1\r\n}\r\n\r\n$logRoot = Join-Path $env:SystemDrive 'Oneclick Logs'\r\nNew-Item -Path $logRoot -ItemType Directory -Force | Out-Null\r\n$script:LogFile = Join-Path $logRoot (\"Oneclick-\" + (Get-Date -Format 'yyyyMMdd-HHmmss') + \".log\")\r\nStart-Transcript -Path (Join-Path $logRoot (\"Transcript-\" + (Get-Date -Format 'yyyyMMdd-HHmmss') + \".txt\")) -Force | Out-Null\r\nWrite-Log \"Log file: $script:LogFile\"\r\n#endregion\r\n\r\n#region Helpers\r\nfunction Invoke-External {\r\n    param(\r\n        [Parameter(Mandatory)] [string] $FilePath,\r\n        [string[]] $Arguments = @(),\r\n        [switch] $IgnoreErrors\r\n    )\r\n    if (-not (Test-Path -LiteralPath $FilePath)) {\r\n        Write-Log \"External tool not found, skipping: $FilePath\" 'WARN'\r\n        return\r\n    }\r\n    try {\r\n        Write-Log \"Running: $FilePath $($Arguments -join ' ')\"\r\n        $p = Start-Process -FilePath $FilePath -ArgumentList $Arguments -Wait -PassThru -WindowStyle Hidden\r\n        Write-Log \"ExitCode: $($p.ExitCode)\"\r\n    }\r\n    catch {\r\n        if ($IgnoreErrors) {\r\n            Write-Log \"External tool failed (ignored): $FilePath - $($_.Exception.Message)\" 'WARN'\r\n        }\r\n        else {\r\n            throw\r\n        }\r\n    }\r\n}\r\n\r\nfunction Invoke-RegExe {\r\n    param(\r\n        [Parameter(Mandatory)] [ValidateSet('add', 'delete')] [string] $Action,\r\n        [Parameter(Mandatory)] [string] $Key,\r\n        [Parameter(Mandatory)] [string] $Rest\r\n    )\r\n    # Split args while preserving quoted segments\r\n    $tokens = [System.Collections.Generic.List[string]]::new()\r\n    foreach ($m in [regex]::Matches($Rest, '\"(?:[^\"\\\\]|\\\\.)*\"|\\S+')) {\r\n        $tokens.Add($m.Value)\r\n    }\r\n    $args = @($Action, $Key) + $tokens.ToArray()\r\n    try {\r\n        Write-Log \"reg.exe $Action $Key $Rest\"\r\n        $null = & reg.exe @args 2>$null\r\n    }\r\n    catch {\r\n        Write-Log \"reg.exe failed: $Action $Key ($($_.Exception.Message))\" 'WARN'\r\n    }\r\n}\r\n\r\nfunction Disable-ScheduledTaskSafe {\r\n    param([Parameter(Mandatory)][string]$TaskName)\r\n    try {\r\n        $t = Get-ScheduledTask -TaskName $TaskName -ErrorAction Stop\r\n        if ($t.State -ne 'Disabled') {\r\n            Disable-ScheduledTask -InputObject $t | Out-Null\r\n            Write-Log \"Disabled scheduled task: $TaskName\"\r\n        }\r\n        else {\r\n            Write-Log \"Scheduled task already disabled: $TaskName\"\r\n        }\r\n    }\r\n    catch {\r\n        Write-Log \"Scheduled task not found / cannot disable: $TaskName\" 'WARN'\r\n    }\r\n}\r\n\r\nfunction Set-ServiceStartMode {\r\n    param(\r\n        [Parameter(Mandatory)][string]$Name,\r\n        [Parameter(Mandatory)][ValidateSet('auto', 'demand', 'disabled')] [string]$Start\r\n    )\r\n    try {\r\n        $null = Get-Service -Name $Name -ErrorAction Stop\r\n        $current = (Get-CimInstance Win32_Service -Filter \"Name='$Name'\" -ErrorAction Stop).StartMode\r\n        $desired = switch ($Start) {\r\n            'auto' { 'Auto' }\r\n            'demand' { 'Manual' }\r\n            'disabled' { 'Disabled' }\r\n        }\r\n        if ($current -notlike \"$desired*\") {\r\n            & sc.exe config $Name start= $Start | Out-Null\r\n            Write-Log \"Service start type set: $Name => $Start\"\r\n        }\r\n        else {\r\n            Write-Log \"Service start type already: $Name => $Start\"\r\n        }\r\n    }\r\n    catch {\r\n        Write-Log \"Service not found / cannot set: $Name\" 'WARN'\r\n    }\r\n}\r\n\r\nfunction Remove-AppxPattern {\r\n    param([Parameter(Mandatory)][string]$Pattern)\r\n    try {\r\n        $pkgs = Get-AppxPackage -AllUsers -Name $Pattern -ErrorAction SilentlyContinue\r\n        foreach ($p in $pkgs) {\r\n            try {\r\n                Write-Log \"Removing AppX (installed): $($p.Name)\"\r\n                Remove-AppxPackage -Package $p.PackageFullName -AllUsers -ErrorAction SilentlyContinue\r\n            }\r\n            catch {\r\n                Write-Log \"Remove-AppxPackage failed for $($p.Name): $($_.Exception.Message)\" 'WARN'\r\n            }\r\n        }\r\n\r\n        $prov = Get-AppxProvisionedPackage -Online | Where-Object { $_.DisplayName -like $Pattern }\r\n        foreach ($pp in $prov) {\r\n            try {\r\n                Write-Log \"Removing AppX (provisioned): $($pp.DisplayName)\"\r\n                Remove-AppxProvisionedPackage -Online -PackageName $pp.PackageName -ErrorAction SilentlyContinue | Out-Null\r\n            }\r\n            catch {\r\n                Write-Log \"Remove-AppxProvisionedPackage failed for $($pp.DisplayName): $($_.Exception.Message)\" 'WARN'\r\n            }\r\n        }\r\n    }\r\n    catch {\r\n        Write-Log \"AppX removal failed for pattern ${Pattern}: $($_.Exception.Message)\" 'WARN'\r\n    }\r\n}\r\n\r\nfunction Expand-BatchPath {\r\n    param(\r\n        [Parameter(Mandatory)][string]$Text,\r\n        [hashtable]$Vars = @{}\r\n    )\r\n    $s = $Text\r\n    foreach ($k in $Vars.Keys) {\r\n        $s = $s -replace [regex]::Escape(\"%$k%\"), [string]$Vars[$k]\r\n    }\r\n    $s = [regex]::Replace($s, '%([A-Za-z0-9_]+)%', {\r\n            param($m)\r\n            $name = $m.Groups[1].Value\r\n            $val = [Environment]::GetEnvironmentVariable($name)\r\n            if ($null -ne $val) { return $val }\r\n            return $m.Value\r\n        })\r\n    return $s\r\n}\r\n#endregion\r\n\r\ntry {\r\n    #region Restore Point (BAT prompted; now auto)\r\n    Write-Log \"Attempting to create a restore point (automatic).\"\r\n    try {\r\n        Invoke-RegExe add 'HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore' '/v \"SystemRestorePointCreationFrequency\" /t REG_DWORD /d 0 /f'\r\n        Enable-ComputerRestore -Drive \"$env:SystemDrive\\\" -ErrorAction SilentlyContinue\r\n        Checkpoint-Computer -Description 'VieXF 1.0.2' -RestorePointType 'MODIFY_SETTINGS' -ErrorAction SilentlyContinue\r\n        Write-Log \"Restore point request submitted.\"\r\n    }\r\n    catch {\r\n        Write-Log \"Restore point creation failed/unsupported: $($_.Exception.Message)\" 'WARN'\r\n    }\r\n    #endregion\r\n\r\n    #region Scheduled Tasks\r\n    Disable-ScheduledTaskSafe -TaskName 'UCPD velocity'\r\n    #endregion\r\n\r\n    #region Registry Tweaks (network-tuning and menu-only branches excluded)\r\n    Write-Log \"Applying registry tweaks.\"\r\n    $RegistryOps = @(\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v HideFileExt /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v Hidden /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'delete'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}'; Rest = '/f' }\r\n        @{ Action = 'delete'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Desktop\\NameSpace\\{f874310e-b6b7-47dc-bc84-b9e6b38f5903}'; Rest = '/f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer'; Rest = '/v HideSCAMeetNow /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'delete'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\NameSpace\\{0DB7E03F-FC29-4DC6-9020-FF41B59E513A}'; Rest = '/f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer'; Rest = '/v NoInstrumentation /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'delete'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\NameSpace\\{3dfdf296-dbec-4fb4-81d1-6a3438bcf4de}'; Rest = '/f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Desktop'; Rest = '/v MenuShowDelay /t REG_SZ /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v Start_TrackProgs /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v HidePeopleBar /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v DisablePreviewDesktop /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v ShowCortanaButton /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v ShowTaskViewButton /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v TaskbarMn /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v TaskbarDa /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v TaskbarAl /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Shell Extensions\\Blocked'; Rest = '/v `{e2bf9676-5f8f-435c-97eb-11607a5bedf7`} /t REG_SZ /d `\"`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v ShowSyncProviderNotifications /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Desktop'; Rest = '/v AutoEndTasks /t REG_SZ /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Desktop'; Rest = '/v WaitToKillAppTimeout /t REG_SZ /d `\"2000`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Control'; Rest = '/v WaitToKillServiceTimeout /t REG_SZ /d `\"2000`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Desktop'; Rest = '/v HungAppTimeout /t REG_SZ /d `\"2000`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Desktop'; Rest = '/v LowLevelHooksTimeout /t REG_SZ /d `\"1000`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Mouse'; Rest = '/v MouseHoverTime /t REG_SZ /d `\"10`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System'; Rest = '/v EnableLUA /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System'; Rest = '/v ConsentPromptBehaviorAdmin /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Desktop'; Rest = '/v WindowArrangementActive /t REG_SZ /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Serialize'; Rest = '/v StartupDelayInMSec /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v ListviewAlphaSelect /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v ListviewShadow /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v TaskbarAnimations /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v ListviewWatermark /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v DisableThumbnailCache /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Desktop'; Rest = '/v UserPreferencesMask /t REG_BINARY /d `\"9012078010000000`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\DWM'; Rest = '/v EnableAeroPeek /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{29`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{30`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{31`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{32`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{33`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{34`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{35`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{36`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{37`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{38`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Icons'; Rest = '/v `{39`} /t REG_SZ /d `\"%SystemRoot%\\System32\\imageres.dll,-134`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\DWM'; Rest = '/v AlwaysHibernateThumbnails /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize'; Rest = '/v EnableTransparency /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize'; Rest = '/v ColorPrevalence /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize'; Rest = '/v AppsUseLightTheme /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize'; Rest = '/v SystemUsesLightTheme /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced'; Rest = '/v LaunchTo /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer'; Rest = '/v NoLowDiskSpaceChecks /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer'; Rest = '/v NoResolveSearch /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer'; Rest = '/v NoResolveTrack /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search'; Rest = '/v AllowCortana /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search'; Rest = '/v DisableWebSearch /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search'; Rest = '/v ConnectedSearchUseWeb /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search'; Rest = '/v ConnectedSearchUseWebOverMeteredConnections /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Search'; Rest = '/v BingSearchEnabled /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Search'; Rest = '/v CortanaConsent /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Search'; Rest = '/v AllowSearchToUseLocation /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Search'; Rest = '/v DeviceHistoryEnabled /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Search'; Rest = '/v HistoryViewEnabled /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search'; Rest = '/v AllowCloudSearch /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search'; Rest = '/v DisableSearchBoxSuggestions /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\SearchSettings'; Rest = '/v IsAADCloudSearchEnabled /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\SearchSettings'; Rest = '/v IsMSACloudSearchEnabled /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\SearchSettings'; Rest = '/v SafeSearchMode /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\SearchSettings'; Rest = '/v IsDeviceSearchHistoryEnabled /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\SearchSettings'; Rest = '/v IsCloudSearchEnabled /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\SearchSettings'; Rest = '/v IsSearchHistoryEnabled /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System'; Rest = '/v DisableCdp /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System'; Rest = '/v DisableActivityFeed /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System'; Rest = '/v PublishUserActivities /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System'; Rest = '/v UploadUserActivities /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection'; Rest = '/v AllowTelemetry /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\DataCollection'; Rest = '/v AllowTelemetry /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection'; Rest = '/v MaxTelemetryAllowed /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\DataCollection'; Rest = '/v MaxTelemetryAllowed /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppCompat'; Rest = '/v AITEnable /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppCompat'; Rest = '/v DisableUAR /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppCompat'; Rest = '/v DisableInventory /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppCompat'; Rest = '/v DisablePCA /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppCompat'; Rest = '/v DisableEngine /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Customer Experience Improvement Program'; Rest = '/v Conset /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Customer Experience Improvement Program'; Rest = '/v DisableCEIP /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Customer Experience Improvement Program'; Rest = '/v DisableUFS /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows'; Rest = '/v CEIPEnable /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC'; Rest = '/v PreventHandwritingDataSharing /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\TextInput'; Rest = '/v AllowLinguisticDataCollection /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\SOFTWARE\\Microsoft\\InputPersonalization'; Rest = '/v RestrictImplicitTextCollection /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\SOFTWARE\\Microsoft\\InputPersonalization'; Rest = '/v RestrictImplicitInkCollection /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\SOFTWARE\\Microsoft\\InputPersonalization\\TrainedDataStore'; Rest = '/v HarvestContacts /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\SOFTWARE\\Microsoft\\Personalization\\Settings'; Rest = '/v AcceptedPrivacyPolicy /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\SOFTWARE\\Microsoft\\InputPersonalization'; Rest = '/v PersonalizationPrivacyConsent /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync\\Groups\\Language'; Rest = '/v Enabled /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync\\Groups\\Language'; Rest = '/v Enabled /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System'; Rest = '/v EnableSmartScreen /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System'; Rest = '/v DisableAcrylicBackgroundOnLogon /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\TimeBrokerSvc'; Rest = '/v Start /t REG_DWORD /d `\"4`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\CDPSvc'; Rest = '/v Start /t REG_DWORD /d `\"4`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\DiagTrack'; Rest = '/v Start /t REG_DWORD /d `\"4`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\diagnosticshub.standardcollector.service'; Rest = '/v Start /t REG_DWORD /d `\"4`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\dmwappushservice'; Rest = '/v Start /t REG_DWORD /d `\"4`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\MapsBroker'; Rest = '/v Start /t REG_DWORD /d `\"4`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\ndu'; Rest = '/v Start /t REG_DWORD /d `\"4`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\PcaSvc'; Rest = '/v Start /t REG_DWORD /d `\"4`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\DirectX\\UserGpuPreferences'; Rest = '/v DirectXUserGlobalSettings /t REG_SZ /d SwapEffectUpgradeEnable=1 /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Accessibility\\StickyKeys'; Rest = '/v Flags /t REG_SZ /d `\"506`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Accessibility\\Keyboard Response'; Rest = '/v Flags /t REG_SZ /d `\"122`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKCU\\Control Panel\\Accessibility\\ToggleKeys'; Rest = '/v Flags /t REG_SZ /d `\"58`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer'; Rest = '/v Max Cached Icons /t REG_SZ /d `\"4096`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SOFTWARE\\Microsoft\\Windows\\Dwm'; Rest = '/v OverlayTestMode /t REG_DWORD /d 5 /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Kernel'; Rest = '/v DynamicHeteroCpuPolicyMask /t REG_DWORD /d `\"3`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Kernel'; Rest = '/v DefaultDynamicHeteroCpuPolicy /t REG_DWORD /d `\"3`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Kernel'; Rest = '/v DynamicHeteroCpuPolicyImportant /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Kernel'; Rest = '/v DynamicHeteroCpuPolicyImportantShort /t REG_DWORD /d `\"1`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Kernel'; Rest = '/v DynamicHeteroCpuPolicyImportantPriority /t REG_DWORD /d `\"8`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Kernel'; Rest = '/v `\"SerializeTimerExpiration`\" /t REG_DWORD /d `\"2`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\kernel'; Rest = '/v `\"TimerCheckFlags`\" /t REG_DWORD /d `\"0`\" /f' }\r\n        @{ Action = 'add'; Key = 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\PriorityControl'; Rest = '/v `\"Win32PrioritySeparation`\" /t REG_DWORD /d `\"0x00000024`\" /f' }\r\n    )\r\n\r\n    foreach ($op in $RegistryOps) {\r\n        Invoke-RegExe -Action $op.Action -Key $op.Key -Rest $op.Rest\r\n    }\r\n    #endregion\r\n\r\n    #region Graphics Preferences / Priority / FSO\r\n    Write-Log \"Applying Graphics Preferences / Priority / FSO rules (only if target files exist).\"\r\n\r\n    $programFilesRoblox = Get-ChildItem 'C:\\Program Files (x86)\\Roblox\\Versions' -Directory -Filter 'version-*' -ErrorAction SilentlyContinue |\r\n    Sort-Object Name -Descending | Select-Object -First 1\r\n    $appDataRoblox = Get-ChildItem (Join-Path $env:LOCALAPPDATA 'Roblox\\Versions') -Directory -Filter 'version-*' -ErrorAction SilentlyContinue |\r\n    Sort-Object Name -Descending | Select-Object -First 1\r\n    $discord = Get-ChildItem (Join-Path $env:LOCALAPPDATA 'Discord') -Directory -Filter 'app-*' -ErrorAction SilentlyContinue |\r\n    Sort-Object Name -Descending | Select-Object -First 1\r\n\r\n    $vars = @{\r\n        ProgramFilesRobloxPath = if ($programFilesRoblox) { Join-Path $programFilesRoblox.FullName 'RobloxPlayerBeta.exe' } else { '' }\r\n        AppDataRobloxPath      = if ($appDataRoblox) { Join-Path $appDataRoblox.FullName 'RobloxPlayerBeta.exe' } else { '' }\r\n        LatestDiscordPath      = if ($discord) { Join-Path $discord.FullName 'Discord.exe' } else { '' }\r\n    }\r\n\r\n    $Games = @(\r\n        \"%ProgramFilesRobloxPath%\"\r\n        \"%AppDataRobloxPath%\"\r\n        \"C:\\Program Files\\Epic Games\\Fortnite\\FortniteGame\\Binaries\\Win64\\FortniteClient-Win64-Shipping.exe\"\r\n        \"C:\\Program Files\\Epic Games\\GTAV\\PlayGTAV.exe\"\r\n        \"C:\\Program Files\\Riot Games\\Riot Client\\RiotClientServices.exe\"\r\n        \"C:\\Riot Games\\VALORANT\\live\\VALORANT.exe\"\r\n        \"%USERPROFILE%\\AppData\\Local\\osu!\\osu!.exe\"\r\n        \"%ProgramFiles%\\Steam\\steamapps\\common\\Counter-Strike Global Offensive\\csgo.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Apex Legends\\r5apex.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Rust\\RustClient.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Overwatch\\Overwatch.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Call of Duty\\cod.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Rainbow Six Siege\\RainbowSix.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\PUBG\\TslGame.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Destiny 2\\destiny2.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\GTA5\\GTA5.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Dota 2\\game\\bin\\win64\\dota2.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Team Fortress 2\\tf.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Warframe\\Warframe.x64.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\ARK\\ShooterGame\\Binaries\\Win64\\ShooterGame.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\GarrysMod\\hl2.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\The Witcher 3\\bin\\x64\\witcher3.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Cyberpunk 2077\\bin\\x64\\Cyberpunk2077.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Elden Ring\\Game\\eldenring.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Hogwarts Legacy\\Phoenix\\Binaries\\Win64\\HogwartsLegacy.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Starfield\\Starfield.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Baldurs Gate 3\\bin\\bg3.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Red Dead Redemption 2\\RDR2.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Forza Horizon 5\\ForzaHorizon5.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\FIFA 23\\FIFA23.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Minecraft\\Launcher\\MinecraftLauncher.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\League of Legends\\LeagueClient.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Rocket League\\Binaries\\Win64\\RocketLeague.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Fall Guys\\FallGuys_client_game.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Dead by Daylight\\DeadByDaylight-Win64-Shipping.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Phasmophobia\\Phasmophobia.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Genshin Impact\\GenshinImpact.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Honkai Star Rail\\StarRail.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\War Thunder\\aces.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\World of Tanks\\WorldOfTanks.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\World of Warcraft\\Wow.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Diablo IV\\Diablo IV.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Path of Exile\\PathOfExile.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Grand Theft Auto San Andreas\\gta_sa.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Need for Speed Heat\\NFSHeat.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Assetto Corsa\\acs.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steamapps\\common\\Project Cars 2\\pCars2.exe\"\r\n    ) | ForEach-Object { Expand-BatchPath -Text $_ -Vars $vars } | Where-Object { $_ -and (Test-Path -LiteralPath $_) }\r\n\r\n    $Apps = @(\r\n        \"%LatestDiscordPath%\"\r\n        \"%USERPROFILE%\\AppData\\Roaming\\Spotify\\Spotify.exe\"\r\n        \"C:\\Program Files (x86)\\MSI Afterburner\\MSIAfterburner.exe\"\r\n        \"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe\"\r\n        \"C:\\Program Files\\Mozilla Firefox\\firefox.exe\"\r\n        \"C:\\Program Files\\BraveSoftware\\Brave-Browser\\Application\\brave.exe\"\r\n        \"C:\\Program Files\\Opera\\launcher.exe\"\r\n        \"C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe\"\r\n        \"C:\\Program Files\\7-Zip\\7zG.exe\"\r\n        \"C:\\Program Files\\VideoLAN\\VLC\\vlc.exe\"\r\n        \"C:\\Program Files\\Notepad++\\notepad++.exe\"\r\n        \"C:\\Program Files\\WinRAR\\WinRAR.exe\"\r\n        \"C:\\Program Files\\qBittorrent\\qbittorrent.exe\"\r\n        \"C:\\Program Files\\Docker\\Docker\\Docker Desktop.exe\"\r\n        \"C:\\Program Files\\Microsoft VS Code\\Code.exe\"\r\n        \"C:\\Program Files\\Core Temp\\Core Temp.exe\"\r\n        \"C:\\Program Files (x86)\\Steam\\steam.exe\"\r\n    ) | ForEach-Object { Expand-BatchPath -Text $_ -Vars $vars } | Where-Object { $_ -and (Test-Path -LiteralPath $_) }\r\n\r\n    $OtherExeNames = @(\r\n        \"Adobe Premiere Pro.exe\"\r\n        \"VegasPro.exe\"\r\n        \"Resolve.exe\"\r\n        \"blender.exe\"\r\n        \"shotcut.exe\"\r\n        \"HandBrake.exe\"\r\n        \"capcut.exe\"\r\n        \"Cinebench.exe\"\r\n        \"3DMark.exe\"\r\n        \"LatMon.exe\"\r\n        \"y-cruncher.exe\"\r\n        \"TM5.exe\"\r\n        \"linpack_xeon64.exe\"\r\n        \"node.exe\"\r\n        \"WinRAR.exe\"\r\n        \"UnRAR.exe\"\r\n        \"Rar.exe\"\r\n        \"7zFM.exe\"\r\n        \"7zG.exe\"\r\n        \"7z.exe\"\r\n    )\r\n\r\n    $regKeyGP = 'HKCU\\SOFTWARE\\Microsoft\\DirectX\\UserGpuPreferences'\r\n    $regKeyPR = 'HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options'\r\n    $regKeyFO = 'HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers'\r\n\r\n    foreach ($path in $Games) {\r\n        $exe = [IO.Path]::GetFileName($path)\r\n        Write-Log \"High Performance + High Priority + FSO: $exe\"\r\n        Invoke-RegExe add $regKeyGP (\"/v `\"$path`\" /t REG_SZ /d `\"GpuPreference=2`\" /f\")\r\n        Invoke-RegExe add (\"$regKeyPR\\$exe\\PerfOptions\") (\"/v `\"CpuPriorityClass`\" /t REG_DWORD /d `\"3`\" /f\")\r\n        Invoke-RegExe add $regKeyFO (\"/v `\"$path`\" /t REG_SZ /d `\"~ DISABLEDXMAXIMIZEDWINDOWEDMODE HIGHDPIAWARE`\" /f\")\r\n    }\r\n\r\n    foreach ($path in $Apps) {\r\n        $exe = [IO.Path]::GetFileName($path)\r\n        Write-Log \"Power Saving + Low Priority: $exe\"\r\n        Invoke-RegExe add $regKeyGP (\"/v `\"$path`\" /t REG_SZ /d `\"GpuPreference=1`\" /f\")\r\n        Invoke-RegExe add (\"$regKeyPR\\$exe\\PerfOptions\") (\"/v `\"CpuPriorityClass`\" /t REG_DWORD /d `\"1`\" /f\")\r\n    }\r\n\r\n    foreach ($exeName in $OtherExeNames) {\r\n        Invoke-RegExe add (\"$regKeyPR\\$exeName\\PerfOptions\") (\"/v `\"CpuPriorityClass`\" /t REG_DWORD /d `\"3`\" /f\")\r\n    }\r\n    #endregion\r\n\r\n    #region App removals\r\n    Write-Log \"Removing bundled AppX packages.\"\r\n    $AppxPatterns = @(\r\n        \"*Clipchamp.Clipchamp*\"\r\n        \"*Microsoft.ApplicationCompatibilityEnhancements*\"\r\n        \"*Microsoft.AV1VideoExtension*\"\r\n        \"*Microsoft.AVCEncoderVideoExtension*\"\r\n        \"*Microsoft.BingNews*\"\r\n        \"*Microsoft.BingSearch*\"\r\n        \"*Microsoft.BingWeather*\"\r\n        \"*Microsoft.Copilot*\"\r\n        \"*Microsoft.Edge.GameAssist*\"\r\n        \"*Microsoft.Family*\"\r\n        \"*Microsoft.GamingApp*\"\r\n        \"*Microsoft.GamingServices*\"\r\n        \"*Microsoft.GetHelp*\"\r\n        \"*Microsoft.Getstarted*\"\r\n        \"*Microsoft.HEIFImageExtension*\"\r\n        \"*Microsoft.HEVCVideoExtension*\"\r\n        \"*Microsoft.MicrosoftEdge.Stable*\"\r\n        \"*Microsoft.MicrosoftOfficeHub*\"\r\n        \"*Microsoft.MicrosoftSolitaireCollection*\"\r\n        \"*Microsoft.MicrosoftStickyNotes*\"\r\n        \"*Microsoft.MixedReality.Portal*\"\r\n        \"*Microsoft.MSPaint*\"\r\n        \"*Microsoft.Office.OneNote*\"\r\n        \"*Microsoft.OneConnect*\"\r\n        \"*Microsoft.OutlookForWindows*\"\r\n        \"*Microsoft.People*\"\r\n        \"*Microsoft.PowerAutomateDesktop*\"\r\n        \"*Microsoft.ScreenSketch*\"\r\n        \"*Microsoft.SkypeApp*\"\r\n        \"*Microsoft.Todos*\"\r\n        \"*Microsoft.Windows.DevHome*\"\r\n        \"*Microsoft.Windows.PeopleExperienceHost*\"\r\n        \"*Microsoft.WindowsAlarms*\"\r\n        \"*Microsoft.WindowsCalculator*\"\r\n        \"*Microsoft.WindowsCamera*\"\r\n        \"*Microsoft.windowscommunicationsapps*\"\r\n        \"*Microsoft.WindowsFeedbackHub*\"\r\n        \"*Microsoft.WindowsMaps*\"\r\n        \"*Microsoft.WindowsNotepad*\"\r\n        \"*Microsoft.WindowsSoundRecorder*\"\r\n        \"*Microsoft.Xbox.TCUI*\"\r\n        \"*Microsoft.XboxApp*\"\r\n        \"*Microsoft.XboxGameOverlay*\"\r\n        \"*Microsoft.XboxGamingOverlay*\"\r\n        \"*Microsoft.XboxIdentityProvider*\"\r\n        \"*Microsoft.XboxSpeechToTextOverlay*\"\r\n        \"*Microsoft.YourPhone*\"\r\n        \"*Microsoft.ZuneMusic*\"\r\n        \"*Microsoft.ZuneVideo*\"\r\n        \"*MicrosoftCorporationII.QuickAssist*\"\r\n        \"*MicrosoftWindows.Client.WebExperience*\"\r\n        \"*MicrosoftWindows.CrossDevice*\"\r\n        \"*MicrosoftWindows.CrossDevice.CSP*\"\r\n        \"*MicrosoftWindows.FeedbackHub*\"\r\n        \"*MicrosoftWindows.FunFacts*\"\r\n        \"*MicrosoftWindows.Launcher*\"\r\n        \"*MicrosoftWindows.NarratorQuickStart*\"\r\n        \"*MicrosoftWindows.PeopleExperienceHost*\"\r\n        \"*MicrosoftWindows.ParentalControls*\"\r\n        \"*MicrosoftWindows.Photos*\"\r\n        \"*MicrosoftWindows.SecureAssessmentBrowser*\"\r\n        \"*MicrosoftWindowsSoundRecorder*\"\r\n        \"*MicrosoftWindowsTerminal*\"\r\n        \"*MicrosoftWindowsWallpaper*\"\r\n        \"*MicrosoftWindowsWidgets*\"\r\n        \"*Windows.CBSPreview*\"\r\n        \"*Windows.DevHome*\"\r\n    )\r\n    foreach ($pat in $AppxPatterns) {\r\n        Remove-AppxPattern -Pattern $pat\r\n    }\r\n    #endregion\r\n\r\n    #region Xbox bloat file deletions (with backup)\r\n    Write-Log \"Deleting Xbox bloat files (if present) and backing up.\"\r\n    $xboxPath = 'C:\\Windows\\System32'\r\n    $backupDir = 'C:\\Oneclick Tools\\Backup\\Xbox Bloat'\r\n    New-Item -Path $backupDir -ItemType Directory -Force | Out-Null\r\n\r\n    $XboxFiles = @(\r\n        \"GameBarPresenceWriter.exe\"\r\n        \"GameBarPresenceWriter.proxy.dll\"\r\n        \"GameChatOverlayExt.dll\"\r\n        \"GameChatTranscription.dll\"\r\n        \"GamePanel.exe\"\r\n        \"GamePanelExternalHook.dll\"\r\n        \"gamestreamingext.dll\"\r\n        \"GameSystemToastIcon.contrast-white.png\"\r\n        \"GameSystemToastIcon.png\"\r\n        \"gameux.dll\"\r\n        \"gamingtcui.dll\"\r\n        \"GraphicsPerfSvc.dll\"\r\n        \"XblAuthManager.dll\"\r\n        \"XblAuthManagerProxy.dll\"\r\n        \"XblAuthTokenBrokerExt.dll\"\r\n        \"XblGameSave.dll\"\r\n        \"XblGameSaveExt.dll\"\r\n        \"XblGameSaveProxy.dll\"\r\n        \"XblGameSaveTask.exe\"\r\n        \"XboxNetApiSvc.dll\"\r\n        \"Windows.Gaming.Preview.dll\"\r\n        \"Windows.Gaming.UI.GameBar.dll\"\r\n        \"Windows.Gaming.XboxLive.Storage.dll\"\r\n    )\r\n    foreach ($f in $XboxFiles) {\r\n        $src = Join-Path $xboxPath $f\r\n        if (Test-Path -LiteralPath $src) {\r\n            try {\r\n                Write-Log \"Removing: $src\"\r\n                takeown /F $src | Out-Null\r\n                icacls $src /grant administrators:F | Out-Null\r\n                Copy-Item -LiteralPath $src -Destination $backupDir -Force -ErrorAction SilentlyContinue\r\n                Remove-Item -LiteralPath $src -Force -ErrorAction SilentlyContinue\r\n            }\r\n            catch {\r\n                Write-Log \"Failed removing ${src}: $($_.Exception.Message)\" 'WARN'\r\n            }\r\n        }\r\n    }\r\n    #endregion\r\n\r\n    #region Services (start type changes)\r\n    Write-Log \"Applying service start-type tweaks.\"\r\n    $Services = @(\r\n        @{ Name = \"ucpd\"; Start = \"disabled\" }\r\n        @{ Name = \"TrustedInstaller\"; Start = \"disabled\" }\r\n        @{ Name = \"VSS\"; Start = \"demand\" }\r\n        @{ Name = \"swprv\"; Start = \"demand\" }\r\n        @{ Name = \"AarSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"ADPSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"AppMgmt\"; Start = \"disabled\" }\r\n        @{ Name = \"AppReadiness\"; Start = \"disabled\" }\r\n        @{ Name = \"AppVClient\"; Start = \"disabled\" }\r\n        @{ Name = \"AssignedAccessManagerSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"AudioEndpointBuilder\"; Start = \"auto\" }\r\n        @{ Name = \"AudioSrv\"; Start = \"auto\" }\r\n        @{ Name = \"AxInstSV\"; Start = \"disabled\" }\r\n        @{ Name = \"BcastDVRUserService\"; Start = \"disabled\" }\r\n        @{ Name = \"BDESVC\"; Start = \"disabled\" }\r\n        @{ Name = \"BITS\"; Start = \"disabled\" }\r\n        @{ Name = \"BrokerInfrastructure\"; Start = \"auto\" }\r\n        @{ Name = \"camsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"CaptureService\"; Start = \"disabled\" }\r\n        @{ Name = \"cbdhsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"CertPropSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"ClipSVC\"; Start = \"disabled\" }\r\n        @{ Name = \"cloudidsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"COMSysApp\"; Start = \"disabled\" }\r\n        @{ Name = \"ConsentUxUserSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"CoreMessagingRegistrar\"; Start = \"auto\" }\r\n        @{ Name = \"CredentialEnrollmentManagerUserSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"CryptSvc\"; Start = \"auto\" }\r\n        @{ Name = \"DcomLaunch\"; Start = \"auto\" }\r\n        @{ Name = \"dcsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"defragsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"DeviceAssociationBrokerSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"DeviceAssociationService\"; Start = \"disabled\" }\r\n        @{ Name = \"DeviceInstall\"; Start = \"disabled\" }\r\n        @{ Name = \"DevicePickerUserSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"DevicesFlowUserSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"DevQueryBroker\"; Start = \"disabled\" }\r\n        @{ Name = \"diagnosticshub.standardcollector.service\"; Start = \"disabled\" }\r\n        @{ Name = \"diagsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"DiagTrack\"; Start = \"disabled\" }\r\n        @{ Name = \"DispBrokerDesktopSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"DisplayEnhancementService\"; Start = \"disabled\" }\r\n        @{ Name = \"DmEnrollmentSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"dmwappushservice\"; Start = \"disabled\" }\r\n        @{ Name = \"DoSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"DPS\"; Start = \"disabled\" }\r\n        @{ Name = \"DsmSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"DsSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"DusmSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"EFS\"; Start = \"disabled\" }\r\n        @{ Name = \"edgeupdate\"; Start = \"disabled\" }\r\n        @{ Name = \"edgeupdatem\"; Start = \"disabled\" }\r\n        @{ Name = \"EFSRPC\"; Start = \"disabled\" }\r\n        @{ Name = \"EmbeddedMode\"; Start = \"disabled\" }\r\n        @{ Name = \"EntAppSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"EventLog\"; Start = \"auto\" }\r\n        @{ Name = \"EventSystem\"; Start = \"auto\" }\r\n        @{ Name = \"fhsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"FontCache\"; Start = \"disabled\" }\r\n        @{ Name = \"FrameServer\"; Start = \"disabled\" }\r\n        @{ Name = \"FrameServerMonitor\"; Start = \"disabled\" }\r\n        @{ Name = \"FvSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"gupdate\"; Start = \"disabled\" }\r\n        @{ Name = \"gupdatem\"; Start = \"disabled\" }\r\n        @{ Name = \"GraphicsPerfSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"HvHost\"; Start = \"disabled\" }\r\n        @{ Name = \"InstallService\"; Start = \"disabled\" }\r\n        @{ Name = \"InventorySvc\"; Start = \"disabled\" }\r\n        @{ Name = \"IpxlatCfgSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"irmon\"; Start = \"disabled\" }\r\n        @{ Name = \"KeyIso\"; Start = \"disabled\" }\r\n        @{ Name = \"KtmRm\"; Start = \"disabled\" }\r\n        @{ Name = \"lfsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"LicenseManager\"; Start = \"disabled\" }\r\n        @{ Name = \"LxpSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"MapsBroker\"; Start = \"disabled\" }\r\n        @{ Name = \"MSDTC\"; Start = \"disabled\" }\r\n        @{ Name = \"MSiSCSI\"; Start = \"disabled\" }\r\n        @{ Name = \"MsKeyboardFilter\"; Start = \"disabled\" }\r\n        @{ Name = \"NaturalAuthentication\"; Start = \"disabled\" }\r\n        @{ Name = \"NcbService\"; Start = \"disabled\" }\r\n        @{ Name = \"NPSMSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"OneSyncSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"P9RdrService\"; Start = \"disabled\" }\r\n        @{ Name = \"PcaSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"PeerDistSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"PerfHost\"; Start = \"disabled\" }\r\n        @{ Name = \"PhoneSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"PimIndexMaintenanceSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"PlugPlay\"; Start = \"auto\" }\r\n        @{ Name = \"PrintNotify\"; Start = \"disabled\" }\r\n        @{ Name = \"ProfSvc\"; Start = \"auto\" }\r\n        @{ Name = \"PushToInstall\"; Start = \"disabled\" }\r\n        @{ Name = \"RemoteRegistry\"; Start = \"disabled\" }\r\n        @{ Name = \"RetailDemo\"; Start = \"disabled\" }\r\n        @{ Name = \"RmSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"RpcEptMapper\"; Start = \"auto\" }\r\n        @{ Name = \"RpcLocator\"; Start = \"disabled\" }\r\n        @{ Name = \"RpcSs\"; Start = \"auto\" }\r\n        @{ Name = \"RSoPProv\"; Start = \"disabled\" }\r\n        @{ Name = \"sacsvr\"; Start = \"disabled\" }\r\n        @{ Name = \"SamSs\"; Start = \"auto\" }\r\n        @{ Name = \"SCardSvr\"; Start = \"disabled\" }\r\n        @{ Name = \"ScDeviceEnum\"; Start = \"disabled\" }\r\n        @{ Name = \"SCPolicySvc\"; Start = \"disabled\" }\r\n        @{ Name = \"SDRSVC\"; Start = \"disabled\" }\r\n        @{ Name = \"seclogon\"; Start = \"disabled\" }\r\n        @{ Name = \"SecurityHealthService\"; Start = \"disabled\" }\r\n        @{ Name = \"SEMgrSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"Sense\"; Start = \"disabled\" }\r\n        @{ Name = \"SensorDataService\"; Start = \"disabled\" }\r\n        @{ Name = \"SensorService\"; Start = \"disabled\" }\r\n        @{ Name = \"SensrSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"SessionEnv\"; Start = \"disabled\" }\r\n        @{ Name = \"SharedRealitySvc\"; Start = \"disabled\" }\r\n        @{ Name = \"ShellHWDetection\"; Start = \"disabled\" }\r\n        @{ Name = \"SmsRouter\"; Start = \"disabled\" }\r\n        @{ Name = \"SNMPTRAP\"; Start = \"disabled\" }\r\n        @{ Name = \"Spooler\"; Start = \"disabled\" }\r\n        @{ Name = \"StiSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"StorSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"svsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"swprv\"; Start = \"demand\" }\r\n        @{ Name = \"SysMain\"; Start = \"disabled\" }\r\n        @{ Name = \"TabletInputService\"; Start = \"disabled\" }\r\n        @{ Name = \"TapiSrv\"; Start = \"disabled\" }\r\n        @{ Name = \"TermService\"; Start = \"disabled\" }\r\n        @{ Name = \"TextInputManagementService\"; Start = \"disabled\" }\r\n        @{ Name = \"Themes\"; Start = \"disabled\" }\r\n        @{ Name = \"TimeBrokerSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"TokenBroker\"; Start = \"disabled\" }\r\n        @{ Name = \"TrkWks\"; Start = \"disabled\" }\r\n        @{ Name = \"TroubleshootingSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"TrustedInstaller\"; Start = \"disabled\" }\r\n        @{ Name = \"tzautoupdate\"; Start = \"disabled\" }\r\n        @{ Name = \"UevAgentService\"; Start = \"disabled\" }\r\n        @{ Name = \"UmRdpService\"; Start = \"disabled\" }\r\n        @{ Name = \"UserDataSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"VaultSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"vds\"; Start = \"disabled\" }\r\n        @{ Name = \"vmcompute\"; Start = \"disabled\" }\r\n        @{ Name = \"vmicguestinterface\"; Start = \"disabled\" }\r\n        @{ Name = \"vmicheartbeat\"; Start = \"disabled\" }\r\n        @{ Name = \"vmickvpexchange\"; Start = \"disabled\" }\r\n        @{ Name = \"vmicrdv\"; Start = \"disabled\" }\r\n        @{ Name = \"vmicshutdown\"; Start = \"disabled\" }\r\n        @{ Name = \"vmictimesync\"; Start = \"disabled\" }\r\n        @{ Name = \"vmicvmsession\"; Start = \"disabled\" }\r\n        @{ Name = \"vmicvss\"; Start = \"disabled\" }\r\n        @{ Name = \"VSS\"; Start = \"demand\" }\r\n        @{ Name = \"W32Time\"; Start = \"disabled\" }\r\n        @{ Name = \"WaaSMedicSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"WalletService\"; Start = \"disabled\" }\r\n        @{ Name = \"WarpJITSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"wbengine\"; Start = \"disabled\" }\r\n        @{ Name = \"WbioSrvc\"; Start = \"disabled\" }\r\n        @{ Name = \"WdiServiceHost\"; Start = \"disabled\" }\r\n        @{ Name = \"WdiSystemHost\"; Start = \"disabled\" }\r\n        @{ Name = \"Wecsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"WEPHOSTSVC\"; Start = \"disabled\" }\r\n        @{ Name = \"wercplsupport\"; Start = \"disabled\" }\r\n        @{ Name = \"WerSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"WiaRpc\"; Start = \"disabled\" }\r\n        @{ Name = \"WinDefend\"; Start = \"disabled\" }\r\n        @{ Name = \"Winmgmt\"; Start = \"auto\" }\r\n        @{ Name = \"wlidsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"wlpasvc\"; Start = \"disabled\" }\r\n        @{ Name = \"WManSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"WpcMonSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"WPDBusEnum\"; Start = \"disabled\" }\r\n        @{ Name = \"WpnService\"; Start = \"disabled\" }\r\n        @{ Name = \"WpnUserService\"; Start = \"disabled\" }\r\n        @{ Name = \"wscsvc\"; Start = \"disabled\" }\r\n        @{ Name = \"WSearch\"; Start = \"disabled\" }\r\n        @{ Name = \"wuauserv\"; Start = \"disabled\" }\r\n        @{ Name = \"XblAuthManager\"; Start = \"disabled\" }\r\n        @{ Name = \"XblGameSave\"; Start = \"disabled\" }\r\n        @{ Name = \"XboxGipSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"XboxNetApiSvc\"; Start = \"disabled\" }\r\n        @{ Name = \"XtaCache\"; Start = \"disabled\" }\r\n        @{ Name = \"EpicGamesUpdater\"; Start = \"auto\" }\r\n        @{ Name = \"EpicOnlineServices\"; Start = \"auto\" }\r\n    )\r\n    foreach ($s in $Services) {\r\n        Set-ServiceStartMode -Name $s.Name -Start $s.Start\r\n    }\r\n    #endregion\r\n\r\n    #region GPU Tweaks (auto-detect)\r\n    Write-Log \"Applying GPU tweaks (auto-detect vendor).\"\r\n    $gpus = Get-CimInstance Win32_VideoController -ErrorAction SilentlyContinue\r\n    $gpuNames = ($gpus | Select-Object -ExpandProperty Name -ErrorAction SilentlyContinue) -join '; '\r\n\r\n    if ($gpuNames -match 'NVIDIA') {\r\n        Write-Log \"Detected NVIDIA GPU(s): $gpuNames\"\r\n        Invoke-External -FilePath 'C:\\Oneclick Tools\\Nvidia Profile Inspector\\nvidiaProfileInspector.exe' -Arguments @('-importProfile', 'C:\\Oneclick Tools\\Nvidia Profile Inspector\\QuakedOptimizedNVProflie.nip') -IgnoreErrors\r\n\r\n        foreach ($k in Get-ChildItem 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Video' -ErrorAction SilentlyContinue) {\r\n            $p = Join-Path $k.PSPath '0000'\r\n            if (Test-Path $p) {\r\n                $reg = $p -replace '^Microsoft\\.PowerShell\\.Core\\\\Registry::', ''\r\n                Invoke-RegExe add $reg '/v \"PowerMizerEnable\" /t REG_DWORD /d \"1\" /f'\r\n                Invoke-RegExe add $reg '/v \"PowerMizerLevel\" /t REG_DWORD /d \"1\" /f'\r\n                Invoke-RegExe add $reg '/v \"PowerMizerLevelAC\" /t REG_DWORD /d \"1\" /f'\r\n                Invoke-RegExe add $reg '/v \"PerfLevelSrc\" /t REG_DWORD /d \"8738\" /f'\r\n            }\r\n        }\r\n        Invoke-RegExe add 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\nvlddmkm\\Global\\NVTweak' '/v \"DisplayPowerSaving\" /t REG_DWORD /d 0 /f'\r\n        Invoke-RegExe add 'HKLM\\SOFTWARE\\NVIDIA Corporation\\NvControlPanel2\\Client' '/v \"OptInOrOutPreference\" /t REG_DWORD /d 0 /f'\r\n        Invoke-RegExe add 'HKLM\\SOFTWARE\\NVIDIA Corporation\\Global\\FTS' '/v \"EnableRID44231\" /t REG_DWORD /d 0 /f'\r\n        Invoke-RegExe add 'HKLM\\SOFTWARE\\NVIDIA Corporation\\Global\\FTS' '/v \"EnableRID64640\" /t REG_DWORD /d 0 /f'\r\n        Invoke-RegExe add 'HKLM\\SOFTWARE\\NVIDIA Corporation\\Global\\FTS' '/v \"EnableRID66610\" /t REG_DWORD /d 0 /f'\r\n        Invoke-RegExe add 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\nvlddmkm\\FTS' '/v \"EnableRID61684\" /t REG_DWORD /d \"1\" /f'\r\n        Invoke-RegExe add 'HKLM\\SYSTEM\\CurrentControlSet\\Services\\nvlddmkm\\Global\\Startup' '/v \"SendTelemetryData\" /t REG_DWORD /d 0 /f'\r\n        Invoke-RegExe delete 'HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run' '/v \"NvBackend\" /f'\r\n\r\n        foreach ($pnp in ($gpus | Select-Object -ExpandProperty PNPDeviceID -ErrorAction SilentlyContinue)) {\r\n            $pnpKey = \"HKLM\\SYSTEM\\CurrentControlSet\\Enum\\$pnp\\Device Parameters\\Interrupt Management\\MessageSignaledInterruptProperties\"\r\n            Invoke-RegExe add $pnpKey '/v MSISupported /t REG_DWORD /d 1 /f'\r\n            Invoke-RegExe delete \"HKLM\\SYSTEM\\CurrentControlSet\\Enum\\$pnp\\Device Parameters\\Interrupt Management\\Affinity Policy\" '/v DevicePriority /f'\r\n        }\r\n\r\n        foreach ($disp in Get-ChildItem 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}' -ErrorAction SilentlyContinue) {\r\n            $k = $disp.PSPath -replace '^Microsoft\\.PowerShell\\.Core\\\\Registry::', ''\r\n            Invoke-RegExe add $k '/v \"RMHdcpKeyGlobZero\" /t REG_DWORD /d 1 /f'\r\n        }\r\n        Invoke-RegExe add 'HKLM\\SOFTWARE\\Microsoft\\Windows\\Dwm' '/v \"OverlayTestMode\" /t REG_DWORD /d 5 /f'\r\n    }\r\n    elseif ($gpuNames -match 'AMD|Radeon') {\r\n        Write-Log \"Detected AMD GPU(s): $gpuNames\"\r\n        $amdValues = @(\r\n            @{ Name = 'EnableUlps'; Type = 'REG_DWORD'; Data = '0' },\r\n            @{ Name = 'EnableAspmL0s'; Type = 'REG_DWORD'; Data = '0' },\r\n            @{ Name = 'EnableAspmL1'; Type = 'REG_DWORD'; Data = '0' },\r\n            @{ Name = 'DisableSAMUPowerGating'; Type = 'REG_DWORD'; Data = '1' },\r\n            @{ Name = 'DisableUVDPowerGatingDynamic'; Type = 'REG_DWORD'; Data = '1' },\r\n            @{ Name = 'DisableVCEPowerGating'; Type = 'REG_DWORD'; Data = '1' },\r\n            @{ Name = 'KMD_DeLagEnabled'; Type = 'REG_DWORD'; Data = '1' },\r\n            @{ Name = 'KMD_FRTEnabled'; Type = 'REG_DWORD'; Data = '0' },\r\n            @{ Name = 'PP_SclkDeepSleepDisable'; Type = 'REG_DWORD'; Data = '1' },\r\n            @{ Name = 'PP_ThermalAutoThrottlingEnable'; Type = 'REG_DWORD'; Data = '0' }\r\n        )\r\n        foreach ($k in Get-ChildItem 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Video' -ErrorAction SilentlyContinue) {\r\n            $p = Join-Path $k.PSPath '0000'\r\n            if (Test-Path $p) {\r\n                $reg = $p -replace '^Microsoft\\.PowerShell\\.Core\\\\Registry::', ''\r\n                foreach ($v in $amdValues) {\r\n                    Invoke-RegExe add $reg (\"/v `\"$($v.Name)`\" /t $($v.Type) /d `\"$($v.Data)`\" /f\")\r\n                }\r\n            }\r\n        }\r\n        foreach ($disp in Get-ChildItem 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}' -ErrorAction SilentlyContinue) {\r\n            $k = $disp.PSPath -replace '^Microsoft\\.PowerShell\\.Core\\\\Registry::', ''\r\n            Invoke-RegExe add $k '/v \"RMHdcpKeyGlobZero\" /t REG_DWORD /d 1 /f'\r\n        }\r\n        Invoke-RegExe add 'HKLM\\SOFTWARE\\Microsoft\\Windows\\Dwm' '/v \"OverlayTestMode\" /t REG_DWORD /d 5 /f'\r\n    }\r\n    else {\r\n        Write-Log \"Detected Intel/Other GPU(s): $gpuNames\"\r\n        foreach ($disp in Get-ChildItem 'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}' -ErrorAction SilentlyContinue) {\r\n            $k = $disp.PSPath -replace '^Microsoft\\.PowerShell\\.Core\\\\Registry::', ''\r\n            Invoke-RegExe add $k '/v \"Disable_OverlayDSQualityEnhancement\" /t REG_DWORD /d \"1\" /f'\r\n            Invoke-RegExe add $k '/v \"IncreaseFixedSegment\" /t REG_DWORD /d \"1\" /f'\r\n            Invoke-RegExe add $k '/v \"AdaptiveVsyncEnable\" /t REG_DWORD /d \"0\" /f'\r\n            Invoke-RegExe add $k '/v \"DisablePFonDP\" /t REG_DWORD /d \"1\" /f'\r\n            Invoke-RegExe add $k '/v \"EnableCompensationForDVI\" /t REG_DWORD /d \"1\" /f'\r\n        }\r\n    }\r\n    #endregion\r\n\r\n    #region BCDEdit + Power Tweaks\r\n    Write-Log \"Applying BCDEdit tweaks.\"\r\n    try { & bcdedit /deletevalue useplatformclock 2>$null | Out-Null } catch { }\r\n    try { & bcdedit /set useplatformtick no 2>$null | Out-Null } catch { }\r\n    try { & bcdedit /set disabledynamictick yes 2>$null | Out-Null } catch { }\r\n\r\n    Write-Log \"Disabling hibernation.\"\r\n    try { & powercfg /hibernate off 2>$null | Out-Null } catch { }\r\n    #endregion\r\n\r\n    #region Power Plan (single-path)\r\n    Write-Log \"Importing and activating Quaked power plans if present.\"\r\n    $pow1 = 'C:\\Oneclick Tools\\Power Plans\\Quaked Ultimate Performance.pow'\r\n    $pow2 = 'C:\\Oneclick Tools\\Power Plans\\Quaked Ultimate Performance Idle Off.pow'\r\n    if (Test-Path $pow1) { try { & powercfg -import $pow1 2>$null | Out-Null } catch { Write-Log \"powercfg import failed: $pow1\" 'WARN' } }\r\n    if (Test-Path $pow2) { try { & powercfg -import $pow2 2>$null | Out-Null } catch { Write-Log \"powercfg import failed: $pow2\" 'WARN' } }\r\n\r\n    $plans = & powercfg /list 2>$null\r\n    $line = ($plans | Select-String -Pattern 'Quaked Ultimate Performance' | Select-Object -First 1)\r\n    if ($line -and $line.ToString() -match '([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})') {\r\n        $g = $Matches[1]\r\n        try { & powercfg /setactive $g 2>$null | Out-Null; Write-Log \"Activated power plan: $g (Quaked Ultimate Performance)\" } catch { Write-Log \"Failed to activate plan: $g\" 'WARN' }\r\n    }\r\n    else {\r\n        Write-Log \"Quaked Ultimate Performance plan not found; leaving active plan unchanged.\" 'WARN'\r\n    }\r\n    #endregion\r\n\r\n    #region File Cleanup (network cleanup removed)\r\n    Write-Log \"Running file cleanup.\"\r\n    $pathsToDelete = @(\r\n        (Join-Path $env:LOCALAPPDATA 'Microsoft\\Windows\\INetCache\\*'),\r\n        (Join-Path $env:TEMP '*'),\r\n        (Join-Path $env:APPDATA 'Discord\\Cache\\*'),\r\n        (Join-Path $env:APPDATA 'Discord\\Code Cache\\*'),\r\n        (Join-Path $env:ProgramData 'USOPrivate\\UpdateStore\\*'),\r\n        (Join-Path $env:ProgramData 'USOShared\\Logs\\*'),\r\n        'C:\\Windows\\System32\\SleepStudy\\*',\r\n        (Join-Path $env:WINDIR 'Logs\\*'),\r\n        (Join-Path $env:LOCALAPPDATA 'Temp\\*'),\r\n        (Join-Path $env:WINDIR 'Temp\\*'),\r\n        'C:\\Windows\\Prefetch\\*'\r\n    )\r\n\r\n    foreach ($p in $pathsToDelete) {\r\n        try {\r\n            if (Test-Path $p) {\r\n                Remove-Item -Path $p -Recurse -Force -ErrorAction SilentlyContinue\r\n                Write-Log \"Deleted: $p\"\r\n            }\r\n        }\r\n        catch {\r\n            Write-Log \"Failed deleting ${p}: $($_.Exception.Message)\" 'WARN'\r\n        }\r\n    }\r\n\r\n    $webCache = Join-Path $env:LOCALAPPDATA 'Microsoft\\Windows\\WebCache'\r\n    if (Test-Path $webCache) {\r\n        try { Remove-Item -LiteralPath $webCache -Recurse -Force -ErrorAction SilentlyContinue; Write-Log \"Removed: $webCache\" } catch { }\r\n    }\r\n    #endregion\r\n\r\n    Write-Log \"Completed.\"\r\n}\r\ncatch {\r\n    Write-Log \"FATAL: $($_.Exception.Message)\" 'ERROR'\r\n    throw\r\n}\r\nfinally {\r\n    Stop-Transcript | Out-Null\r\n}\r\n",
        "unapply": "$balancedGUID = \"381b4222-f694-41f0-9685-ff5bb260df2e\"\r\n  \r\n  # check if the Balanced plan exists\r\n  $balancedExists = powercfg -l | Select-String $balancedGUID\r\n  \r\n  if ($balancedExists) {\r\n      powercfg -setactive $balancedGUID\r\n      Write-Host \"Balanced power plan is now active.\" \r\n  } else {\r\n      Write-Host \"Balanced power plan not found. Creating a new Balanced plan...\" \r\n      powercfg -duplicatescheme $balancedGUID\r\n      powercfg -setactive $balancedGUID\r\n      Write-Host \"Balanced power plan created and activated.\" \r\n  }"
      }
    }
  ]
}